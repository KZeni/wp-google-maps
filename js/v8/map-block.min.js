jQuery(function($){var core={maps:[],events:null,settings:null,loadingHTML:'<div class="map-block-preloader"><div class="map-block-loader">...</div></div>',getScrollAnimationOffset:function(){return map-block.settings.scroll_animation_offset||0},animateScroll:function(element,milliseconds){var offset=map-block.getScrollAnimationOffset();milliseconds||(milliseconds=map-block.settings.scroll_animation_milliseconds?map-block.settings.scroll_animation_milliseconds:500),$("html, body").animate({scrollTop:$(element).offset().top-offset},milliseconds)},guid:function(){var d=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(d+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=(d+16*Math.random())%16|0;return d=Math.floor(d/16),("x"===c?r:3&r|8).toString(16)})},hexOpacityToRGBA:function(colour,opacity){return hex=parseInt(colour.replace(/^#/,""),16),[(16711680&hex)>>16,(65280&hex)>>8,255&hex,parseFloat(opacity)]},latLngRegexp:/^(\-?\d+(\.\d+)?),\s*(\-?\d+(\.\d+)?)$/,isLatLngString:function(str){if("string"!=typeof str)return null;str.match(/^\(.+\)$/)&&(str=str.replace(/^\(|\)$/,""));var m=str.match(map-block.latLngRegexp);return m?{lat:parseFloat(m[1]),lng:parseFloat(m[3])}:null},stringToLatLng:function(str){var result=map-block.isLatLngString(str);if(!result)throw new Error("Not a valid latLng");return result},isHexColorString:function(str){return"string"==typeof str&&!!str.match(/#[0-9A-F]{6}/i)},imageDimensionsCache:{},getImageDimensions:function(src,callback){if(map-block.imageDimensionsCache[src])callback(map-block.imageDimensionsCache[src]);else{var img=document.createElement("img");img.onload=function(event){var result={width:image.width,height:image.height};map-block.imageDimensionsCache[src]=result,callback(result)},img.src=src}},isDeveloperMode:function(){return this.developer_mode||window.Cookies&&window.Cookies.get("map-block-developer-mode")},isProVersion:function(){return"1"==this._isProVersion},openMediaDialog:function(callback){var file_frame;if(file_frame)return file_frame.uploader.uploader.param("post_id",set_to_post_id),void file_frame.open();(file_frame=wp.media.frames.file_frame=wp.media({title:"Select a image to upload",button:{text:"Use this image"},multiple:!1})).on("select",function(){attachment=file_frame.state().get("selection").first().toJSON(),callback(attachment.id,attachment.url)}),file_frame.open()},getCurrentPosition:function(callback){if(navigator.geolocation){var options={enableHighAccuracy:!0};navigator.geolocation.getCurrentPosition(function(position){callback&&callback(position),map-block.events.trigger("userlocationfound")},function(error){options.enableHighAccuracy=!1,navigator.geolocation.getCurrentPosition(function(position){callback&&callback(position),map-block.events.trigger("userlocationfound")},function(error){console.warn(error.code,error.message)},options)},options)}else console.warn("No geolocation available on this device")},runCatchableTask:function(callback,friendlyErrorContainer){if(map-block.isDeveloperMode())callback();else try{callback()}catch(e){var friendlyError=new map-block.FriendlyError(e);$(friendlyErrorContainer).html(""),$(friendlyErrorContainer).append(friendlyError.element),$(friendlyErrorContainer).show()}},assertInstanceOf:function(instance,instanceName){var engine,fullInstanceName,pro=map-block.isProVersion()?"Pro":"";switch(map-block.settings.engine){case"open-layers":engine="OL";break;default:engine="Google"}if(fullInstanceName=map-block[engine+pro+instanceName]?engine+pro+instanceName:map-block[pro+instanceName]?pro+instanceName:map-block[engine+instanceName]?engine+instanceName:instanceName,!(instance instanceof map-block[fullInstanceName]))throw new Error("Object must be an instance of "+fullInstanceName+" (did you call a constructor directly, rather than createInstance?)")},getMapByID:function(id){for(var i=0;i<map-block.maps.length;i++)if(map-block.maps[i].id==id)return map-block.maps[i];return null},isGoogleAutocompleteSupported:function(){return"object"==typeof google&&"object"==typeof google.maps&&"object"==typeof google.maps.places&&"function"==typeof google.maps.places.Autocomplete},googleAPIStatus:window.map-block_google_api_status,isDeviceiOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream||!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)}};for(var key in window.map-block?window.map-block=$.extend(window.map-block,core):window.map-block=core,map-block_localized_data){var value=map-block_localized_data[key];map-block[key]=value}jQuery(function($){$("script[src*='map-block.combined.js'], script[src*='map-block-pro.combined.js']").length&&console.warn("Minified script is out of date, using combined script instead.");var elements=$("script").filter(function(){return this.src.match(/(^|\/)jquery\.(min\.)?js(\?|$)/i)});1<elements.length&&console.warn("Multiple jQuery versions detected: ",elements),map-block.restAPI=map-block.RestAPI.createInstance(),$(document).on("click",".map-block_edit_btn",function(){map-block.animateScroll("#map-blockaps_tabs_markers")})}),$(window).on("load",function(event){if("https:"!=window.location.protocol){var warning='<div class="notice notice-warning"><p>'+map-block.localized_strings.unsecure_geolocation+"</p></div>";$(".map-block-geolocation-setting").each(function(index,el){$(el).after($(warning))})}})}),jQuery(function($){map-block.Compatibility=function(){this.preventDocumentWriteGoogleMapsAPI()},map-block.Compatibility.prototype.preventDocumentWriteGoogleMapsAPI=function(){var old=document.write;document.write=function(content){content.match&&content.match(/maps\.google/)||old.call(document,content)}},map-block.compatiblityModule=new map-block.Compatibility}),function(root,factory){"object"==typeof exports?module.exports=factory(root):"function"==typeof define&&define.amd?define([],factory.bind(root,root)):factory(root)}("undefined"!=typeof global?global:this,function(root){if(root.CSS&&root.CSS.escape)return root.CSS.escape;var cssEscape=function(value){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var codeUnit,string=String(value),length=string.length,index=-1,result="",firstCodeUnit=string.charCodeAt(0);++index<length;)0!=(codeUnit=string.charCodeAt(index))?result+=1<=codeUnit&&codeUnit<=31||127==codeUnit||0==index&&48<=codeUnit&&codeUnit<=57||1==index&&48<=codeUnit&&codeUnit<=57&&45==firstCodeUnit?"\\"+codeUnit.toString(16)+" ":(0!=index||1!=length||45!=codeUnit)&&(128<=codeUnit||45==codeUnit||95==codeUnit||48<=codeUnit&&codeUnit<=57||65<=codeUnit&&codeUnit<=90||97<=codeUnit&&codeUnit<=122)?string.charAt(index):"\\"+string.charAt(index):result+="ï¿½";return result};return root.CSS||(root.CSS={}),root.CSS.escape=cssEscape}),jQuery(function($){map-block.Distance={MILES:!0,KILOMETERS:!1,MILES_PER_KILOMETER:.621371,KILOMETERS_PER_MILE:1.60934,uiToMeters:function(uiDistance){return parseFloat(uiDistance)/(map-block.settings.distance_units==map-block.Distance.MILES?map-block.Distance.MILES_PER_KILOMETER:1)*1e3},uiToKilometers:function(uiDistance){return.001*map-block.Distance.uiToMeters(uiDistance)},uiToMiles:function(uiDistance){return map-block.Distance.uiToKilometers(uiDistance)*map-block.Distance.MILES_PER_KILOMETER},kilometersToUI:function(km){return map-block.settings.distance_units==map-block.Distance.MILES?km*map-block.Distance.MILES_PER_KILOMETER:km}}}),jQuery(function($){map-block.EventDispatcher=function(){map-block.assertInstanceOf(this,"EventDispatcher"),this._listenersByType=[]},map-block.EventDispatcher.prototype.addEventListener=function(type,listener,thisObject,useCapture){var arr,types=type.split(/\s+/);if(1<types.length)for(var i=0;i<types.length;i++)this.addEventListener(types[i],listener,thisObject,useCapture);else{if(!(listener instanceof Function))throw new Error("Listener must be a function");(arr=this._listenersByType[type])||(arr=this._listenersByType[type]=[]);var obj={listener:listener,thisObject:thisObject||this,useCapture:!!useCapture};arr.push(obj)}},map-block.EventDispatcher.prototype.on=map-block.EventDispatcher.prototype.addEventListener,map-block.EventDispatcher.prototype.removeEventListener=function(type,listener,thisObject,useCapture){var arr,obj;if(arr=this._listenersByType[type]){thisObject||(thisObject=this),useCapture=!!useCapture;for(var i=0;i<arr.length;i++)if((obj=arr[i]).listener==listener&&obj.thisObject==thisObject&&obj.useCapture==useCapture)return void arr.splice(i,1)}},map-block.EventDispatcher.prototype.off=map-block.EventDispatcher.prototype.removeEventListener,map-block.EventDispatcher.prototype.hasEventListener=function(type){return!!_listenersByType[type]},map-block.EventDispatcher.prototype.dispatchEvent=function(event){if(!(event instanceof map-block.Event))if("string"==typeof event)event=new map-block.Event(event);else{var src=event;for(var name in event=new map-block.Event,src)event[name]=src[name]}for(var path=[],obj=(event.target=this).parent;null!=obj;obj=obj.parent)path.unshift(obj);event.phase=map-block.Event.CAPTURING_PHASE;for(var i=0;i<path.length&&!event._cancelled;i++)path[i]._triggerListeners(event);if(!event._cancelled){for(event.phase=map-block.Event.AT_TARGET,this._triggerListeners(event),event.phase=map-block.Event.BUBBLING_PHASE,i=path.length-1;0<=i&&!event._cancelled;i--)path[i]._triggerListeners(event);if(this.element){var customEvent={};for(var key in event){var value=event[key];"type"==key&&(value+=".map-block"),customEvent[key]=value}$(this.element).trigger(customEvent)}}},map-block.EventDispatcher.prototype.trigger=map-block.EventDispatcher.prototype.dispatchEvent,map-block.EventDispatcher.prototype._triggerListeners=function(event){var arr,obj;if(arr=this._listenersByType[event.type])for(var i=0;i<arr.length;i++)obj=arr[i],(event.phase!=map-block.Event.CAPTURING_PHASE||obj.useCapture)&&obj.listener.call(arr[i].thisObject,event)},map-block.events=new map-block.EventDispatcher}),jQuery(function($){map-block.Event=function(options){if("string"==typeof options&&(this.type=options),this.bubbles=!0,this.cancelable=!0,this.phase=map-block.Event.PHASE_CAPTURE,this.target=null,this._cancelled=!1,"object"==typeof options)for(var name in options)this[name]=options[name]},map-block.Event.CAPTURING_PHASE=0,map-block.Event.AT_TARGET=1,map-block.Event.BUBBLING_PHASE=2,map-block.Event.prototype.stopPropagation=function(){this._cancelled=!0}}),jQuery(function($){}),jQuery(function($){map-block.Geocoder=function(){map-block.assertInstanceOf(this,"Geocoder")},map-block.Geocoder.SUCCESS="success",map-block.Geocoder.ZERO_RESULTS="zero-results",map-block.Geocoder.FAIL="fail",map-block.Geocoder.getConstructor=function(){switch(map-block.settings.engine){case"open-layers":return map-block.OLGeocoder;default:return map-block.GoogleGeocoder}},map-block.Geocoder.createInstance=function(){return new(map-block.Geocoder.getConstructor())},map-block.Geocoder.prototype.getLatLngFromAddress=function(options,callback){if(map-block.isLatLngString(options.address)){var parts=options.address.split(/,\s*/);callback([new map-block.LatLng({lat:parseFloat(parts[0]),lng:parseFloat(parts[1])})],map-block.Geocoder.SUCCESS)}},map-block.Geocoder.prototype.getAddressFromLatLng=function(options,callback){callback([new map-block.LatLng(options.latLng).toString()],map-block.Geocoder.SUCCESS)},map-block.Geocoder.prototype.geocode=function(options,callback){if("address"in options)return this.getLatLngFromAddress(options,callback);if("latLng"in options)return this.getAddressFromLatLng(options,callback);throw new Error("You must supply either a latLng or address")}}),jQuery(function($){map-block.GoogleAPIErrorHandler=function(){var self=this;if("google-maps"==map-block.settings.engine&&("map-edit"==map-block.currentPage||0==map-block.is_admin&&1==map-block.userCanAdministrator)&&(this.element=$(map-block.html.googleMapsAPIErrorDialog),1==map-block.is_admin&&this.element.find(".map-block-front-end-only").remove(),this.errorMessageList=this.element.find("#map-block-google-api-error-list"),this.templateListItem=this.element.find("li.template").remove(),this.messagesAlreadyDisplayed={},!map-block.settings.developer_mode)){var _error=console.error;console.error=function(message){self.onErrorMessage(message),_error.apply(this,arguments)}}},map-block.GoogleAPIErrorHandler.prototype.onErrorMessage=function(message){var m;if((m=message.match(/You have exceeded your (daily )?request quota for this API/))||(m=message.match(/This API project is not authorized to use this API/))){var urls=message.match(/http(s)?:\/\/[^\s]+/gm);this.addErrorMessage(m[0],urls)}else(m=message.match(/^Google Maps.+error: (.+)\s+(http(s?):\/\/.+)/m))&&this.addErrorMessage(m[1].replace(/([A-Z])/g," $1"),[m[2]])},map-block.GoogleAPIErrorHandler.prototype.addErrorMessage=function(message,urls){if(!this.messagesAlreadyDisplayed[message]){var li=this.templateListItem.clone();$(li).find(".map-block-message").html(message);var buttonContainer=$(li).find(".map-block-documentation-buttons"),buttonTemplate=$(li).find(".map-block-documentation-buttons>a");if(buttonTemplate.remove(),urls&&urls.length){for(var i=0;i<urls.length;i++){var url=urls[i],button=buttonTemplate.clone(),icon="fa-external-link",text=map-block.localized_strings.documentation;button.attr("href",urls[i]),url.match(/google.+documentation/)?icon="fa-google":url.match(/maps-no-account/)?(icon="fa-wrench",text=map-block.localized_strings.verify_project):url.match(/console\.developers\.google/)&&(icon="fa-wrench",text=map-block.localized_strings.api_dashboard),$(button).find("i").addClass(icon),$(button).append(text)}buttonContainer.append(button)}switch($(this.errorMessageList).append(li),this.dialog||(this.dialog=$(this.element).remodal()),this.dialog.getState()){case"open":case"opened":case"opening":break;default:this.dialog.open()}this.messagesAlreadyDisplayed[message]=!0}},map-block.googleAPIErrorHandler=new map-block.GoogleAPIErrorHandler}),jQuery(function($){map-block.InfoWindow=function(mapObject){var self=this;map-block.EventDispatcher.call(this),map-block.assertInstanceOf(this,"InfoWindow"),mapObject&&((this.mapObject=mapObject).map?setTimeout(function(){self.onMapObjectAdded(event)},100):mapObject.addEventListener("added",function(event){self.onMapObjectAdded(event)}))},map-block.InfoWindow.prototype=Object.create(map-block.EventDispatcher.prototype),map-block.InfoWindow.prototype.constructor=map-block.InfoWindow,map-block.InfoWindow.OPEN_BY_CLICK=1,map-block.InfoWindow.OPEN_BY_HOVER=2,map-block.InfoWindow.getConstructor=function(){switch(map-block.settings.engine){case"open-layers":return map-block.isProVersion()?map-block.OLProInfoWindow:map-block.OLInfoWindow;default:return map-block.isProVersion()?map-block.GoogleProInfoWindow:map-block.GoogleInfoWindow}},map-block.InfoWindow.createInstance=function(mapObject){return new(this.getConstructor())(mapObject)},map-block.InfoWindow.prototype.getContent=function(callback){var html="";this.mapObject instanceof map-block.Marker&&(html=this.mapObject.address),callback(html)},map-block.InfoWindow.prototype.open=function(map,mapObject){return this.mapObject=mapObject,!map-block.settings.disable_infowindows},map-block.InfoWindow.prototype.close=function(){},map-block.InfoWindow.prototype.setContent=function(options){},map-block.InfoWindow.prototype.setOptions=function(options){},map-block.InfoWindow.prototype.onMapObjectAdded=function(){1==this.mapObject.settings.infoopen&&this.open()}}),jQuery(function($){map-block.LatLng=function(arg,lng){if(this._lat=0,(this._lng=0)!=arguments.length)if(1==arguments.length){if("string"==typeof arg){var m;if(!(m=arg.match(map-block.LatLng.REGEXP)))throw new Error("Invalid LatLng string");arg={lat:m[1],lng:m[3]}}if("object"!=typeof arg||!("lat"in arg&&"lng"in arg))throw new Error("Argument must be a LatLng literal");this.lat=arg.lat,this.lng=arg.lng}else this.lat=arg,this.lng=lng},map-block.LatLng.REGEXP=/^(\-?\d+(\.\d+)?),\s*(\-?\d+(\.\d+)?)$/,map-block.LatLng.isValid=function(obj){return"object"==typeof obj&&("lat"in obj&&"lng"in obj)},Object.defineProperty(map-block.LatLng.prototype,"lat",{get:function(){return this._lat},set:function(val){if(!$.isNumeric(val))throw new Error("Latitude must be numeric");this._lat=parseFloat(val)}}),Object.defineProperty(map-block.LatLng.prototype,"lng",{get:function(){return this._lng},set:function(val){if(!$.isNumeric(val))throw new Error("Longitude must be numeric");this._lng=parseFloat(val)}}),map-block.LatLng.prototype.toString=function(){return this._lat+", "+this._lng},map-block.LatLng.fromGoogleLatLng=function(googleLatLng){return new map-block.LatLng(googleLatLng.lat(),googleLatLng.lng())},map-block.LatLng.prototype.toGoogleLatLng=function(){return new google.maps.LatLng({lat:this.lat,lng:this.lng})},map-block.LatLng.prototype.moveByDistance=function(kilometers,heading){var delta=parseFloat(kilometers)/6371,theta=parseFloat(heading)/180*Math.PI,phi1=this.lat/180*Math.PI,lambda1=this.lng/180*Math.PI,sinPhi1=Math.sin(phi1),cosPhi1=Math.cos(phi1),sinDelta=Math.sin(delta),cosDelta=Math.cos(delta),sinTheta=Math.sin(theta),sinPhi2=sinPhi1*cosDelta+cosPhi1*sinDelta*Math.cos(theta),phi2=Math.asin(sinPhi2),y=sinTheta*sinDelta*cosPhi1,x=cosDelta-sinPhi1*sinPhi2,lambda2=lambda1+Math.atan2(y,x);this.lat=180*phi2/Math.PI,this.lng=180*lambda2/Math.PI}}),jQuery(function($){map-block.LatLngBounds=function(southWest,northEast){},map-block.LatLngBounds.prototype.isInInitialState=function(){return null==this.north&&null==this.south&&null==this.west&&null==this.east},map-block.LatLngBounds.prototype.extend=function(latLng){this.isInInitialState()?this.north=this.south=this.west=this.east=new map-block.LatLng(latLng):(latLng instanceof map-block.LatLng||(latLng=new map-block.LatLng(latLng)),latLng.lat<this.north&&(this.north=latLng.lat),latLng.lat>this.south&&(this.south=latLng.lat),latLng.lng<this.west&&(this.west=latLng.lng),latLng.lng>this.east&&(this.east=latLng.lng))}}),jQuery(function($){map-block.MapObject=function(row){if(map-block.assertInstanceOf(this,"MapObject"),map-block.EventDispatcher.call(this),this.id=-1,this.guid=map-block.guid(),this.modified=!0,this.settings={},row)for(var name in row)if("settings"==name){if(null==row.settings)this.settings={};else switch(typeof row.settings){case"string":this.settings=JSON.parse(row[name]);break;case"object":this.settings=row[name];break;default:throw new Error("Don't know how to interpret settings")}for(var name in this.settings){var value=this.settings[name];String(value).match(/^-?\d+$/)&&(this.settings[name]=parseInt(value))}}else this[name]=row[name]},map-block.MapObject.prototype=Object.create(map-block.EventDispatcher.prototype),map-block.MapObject.prototype.constructor=map-block.MapObject,map-block.MapObject.prototype.parseGeometry=function(string){var pairs,coords,results=[];pairs=string.replace(/[^ ,\d\.\-+e]/g,"").split(",");for(var i=0;i<pairs.length;i++)coords=pairs[i].split(" "),results.push({lat:parseFloat(coords[1]),lng:parseFloat(coords[0])});return results},map-block.MapObject.prototype.toJSON=function(){return{id:this.id,guid:this.guid,settings:this.settings}}}),jQuery(function($){var Parent=map-block.MapObject;map-block.Circle=function(options,engineCircle){map-block.assertInstanceOf(this,"Circle"),this.center=new map-block.LatLng,this.radius=100,Parent.apply(this,arguments)},map-block.Circle.prototype=Object.create(Parent.prototype),map-block.Circle.prototype.constructor=map-block.Circle,map-block.Circle.createInstance=function(options){return new("google-maps"==map-block.settings.engine?map-block.GoogleCircle:map-block.OLCircle)(options)},map-block.Circle.prototype.getCenter=function(){return this.center.clone()},map-block.Circle.prototype.setCenter=function(latLng){this.center.lat=latLng.lat,this.center.lng=latLng.lng},map-block.Circle.prototype.getRadius=function(){return this.radius},map-block.Circle.prototype.setRadius=function(radius){this.radius=radius},map-block.Circle.prototype.getMap=function(){return this.map},map-block.Circle.prototype.setMap=function(map){this.map&&this.map.removeCircle(this),map&&map.addCircle(this)}}),jQuery(function($){map-block.MapSettingsPage=function(){var self=this;this.updateEngineSpecificControls(),this.updateGDPRControls(),$("select[name='map-block_maps_engine']").on("change",function(event){self.updateEngineSpecificControls()}),$("input[name='map-block_gdpr_require_consent_before_load'], input[name='map-block_gdpr_require_consent_before_vgm_submit'], input[name='map-block_gdpr_override_notice']").on("change",function(event){self.updateGDPRControls()})},map-block.MapSettingsPage.prototype.updateEngineSpecificControls=function(){var engine=$("select[name='map-block_maps_engine']").val();$("[data-required-maps-engine][data-required-maps-engine!='"+engine+"']").hide(),$("[data-required-maps-engine='"+engine+"']").show()},map-block.MapSettingsPage.prototype.updateGDPRControls=function(){var showNoticeControls=$("input[name='map-block_gdpr_require_consent_before_load']").prop("checked"),vgmCheckbox=$("input[name='map-block_gdpr_require_consent_before_vgm_submit']");vgmCheckbox.length&&(showNoticeControls=showNoticeControls||vgmCheckbox.prop("checked"));var showOverrideTextarea=showNoticeControls&&$("input[name='map-block_gdpr_override_notice']").prop("checked");showNoticeControls?$("#map-block-gdpr-compliance-notice").show("slow"):$("#map-block-gdpr-compliance-notice").hide("slow"),showOverrideTextarea?$("#map-block_gdpr_override_notice_text").show("slow"):$("#map-block_gdpr_override_notice_text").hide("slow")},jQuery(function($){window.location.href.match(/map-block-menu-settings/)&&(map-block.mapSettingsPage=new map-block.MapSettingsPage)})}),jQuery(function($){map-block.MapSettings=function(element){var str=element.getAttribute("data-settings"),json=JSON.parse(str);for(var key in map-block.assertInstanceOf(this,"MapSettings"),map-block.settings){var value=map-block.settings[key];this[key]=value}for(var key in json){value=json[key];String(value).match(/^-?\d+$/)&&(value=parseInt(value)),this[key]=value}},map-block.MapSettings.prototype.toOLViewOptions=function(){var options={center:ol.proj.fromLonLat([-119.4179,36.7783]),zoom:4};function empty(name){return"object"!=typeof self[name]&&(!self[name]||!self[name].length)}if("string"==typeof this.start_location){var coords=this.start_location.replace(/^\(|\)$/g,"").split(",");map-block.isLatLngString(this.start_location)?options.center=ol.proj.fromLonLat([parseFloat(coords[1]),parseFloat(coords[0])]):console.warn("Invalid start location")}return this.center&&(options.center=ol.proj.fromLonLat([parseFloat(this.center.lng),parseFloat(this.center.lat)])),this.zoom&&(options.zoom=parseInt(this.zoom)),this.start_zoom&&(options.zoom=parseInt(this.start_zoom)),empty("min_zoom")||(options.minZoom=parseInt(this.min_zoom)),empty("max_zoom")||(options.maxZoom=parseInt(this.max_zoom)),options},map-block.MapSettings.prototype.toGoogleMapsOptions=function(){var self=this,latLngCoords=this.start_location&&this.start_location.length?this.start_location.split(","):[36.7783,-119.4179];function empty(name){return"object"!=typeof self[name]&&(!self[name]||!self[name].length)}function formatCoord(coord){return $.isNumeric(coord)?coord:parseFloat(String(coord).replace(/[\(\)\s]/,""))}var latLng=new google.maps.LatLng(formatCoord(latLngCoords[0]),formatCoord(latLngCoords[1])),zoom=this.start_zoom?parseInt(this.start_zoom):4;!this.start_zoom&&this.zoom&&(zoom=parseInt(this.zoom));var options={zoom:zoom,center:latLng};switch(empty("center")||(options.center=new google.maps.LatLng({lat:parseFloat(this.center.lat),lng:parseFloat(this.center.lng)})),empty("min_zoom")||(options.minZoom=parseInt(this.min_zoom)),empty("max_zoom")||(options.maxZoom=parseInt(this.max_zoom)),options.zoomControl=!("yes"==this.map-block_settings_map_zoom),options.panControl=!("yes"==this.map-block_settings_map_pan),options.mapTypeControl=!("yes"==this.map-block_settings_map_type),options.streetViewControl=!("yes"==this.map-block_settings_map_streetview),options.fullscreenControl=!("yes"==this.map-block_settings_map_full_screen_control),options.draggable=!("yes"==this.map-block_settings_map_draggable),options.disableDoubleClickZoom=!("yes"==this.map-block_settings_map_clickzoom),options.scrollwheel=!("yes"==this.map-block_settings_map_scroll),"greedy"==this.map-block_force_greedy_gestures||"yes"==this.map-block_force_greedy_gestures?options.gestureHandling="greedy":options.gestureHandling="cooperative",parseInt(this.map_type)){case 2:options.mapTypeId=google.maps.MapTypeId.SATELLITE;break;case 3:options.mapTypeId=google.maps.MapTypeId.HYBRID;break;case 4:options.mapTypeId=google.maps.MapTypeId.TERRAIN;break;default:options.mapTypeId=google.maps.MapTypeId.ROADMAP}if(this.theme_data&&0<this.theme_data.length)try{options.styles=JSON.parse(this.theme_data)}catch(e){alert("Your theme data is not valid JSON and has been ignored")}return options}}),jQuery(function($){map-block.Map=function(element,options){if(map-block.assertInstanceOf(this,"Map"),map-block.EventDispatcher.call(this),!(element instanceof HTMLElement))throw new Error("Argument must be a HTMLElement");if(this.id=element.getAttribute("data-map-id"),!/\d+/.test(this.id))throw new Error("Map ID must be an integer");map-block.maps.push(this),this.element=element,(this.element.map-blockMap=this).engineElement=element,this.markers=[],this.polygons=[],this.polylines=[],this.circles=[],this.loadSettings(options)},map-block.Map.prototype=Object.create(map-block.EventDispatcher.prototype),map-block.Map.prototype.constructor=map-block.Map,map-block.Map.getConstructor=function(){switch(map-block.settings.engine){case"open-layers":return map-block.isProVersion()?map-block.OLProMap:map-block.OLMap;default:return map-block.isProVersion()?map-block.GoogleProMap:map-block.GoogleMap}},map-block.Map.createInstance=function(element,options){return new(map-block.Map.getConstructor())(element,options)},map-block.Map.prototype.loadSettings=function(options){var settings=new map-block.MapSettings(this.element),other_settings=settings.other_settings;if(delete settings.other_settings,other_settings)for(var key in other_settings)settings[key]=other_settings[key];if(options)for(var key in options)settings[key]=options[key];this.settings=settings},map-block.Map.prototype.setOptions=function(options){for(var name in options)this.settings[name]=options[name]};Math.PI;function deg2rad(deg){return deg*(Math.PI/180)}map-block.Map.getGeographicDistance=function(lat1,lon1,lat2,lon2){var dLat=deg2rad(lat2-lat1),dLon=deg2rad(lon2-lon1),a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(deg2rad(lat1))*Math.cos(deg2rad(lat2))*Math.sin(dLon/2)*Math.sin(dLon/2);return 6371*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)))},map-block.Map.prototype.setCenter=function(latLng){if(!("lat"in latLng&&"lng"in latLng))throw new Error("Argument is not an object with lat and lng")},map-block.Map.prototype.setDimensions=function(width,height){$(this.element).css({width:width}),$(this.engineElement).css({width:"100%",height:height})},map-block.Map.prototype.addMarker=function(marker){if(!(marker instanceof map-block.Marker))throw new Error("Argument must be an instance of map-block.Marker");marker.map=this,(marker.parent=this).markers.push(marker),this.dispatchEvent({type:"markeradded",marker:marker}),marker.dispatchEvent({type:"added"})},map-block.Map.prototype.removeMarker=function(marker){if(!(marker instanceof map-block.Marker))throw new Error("Argument must be an instance of map-block.Marker");if(marker.map!==this)throw new Error("Wrong map error");marker.map=null,marker.parent=null,this.markers.splice(this.markers.indexOf(marker),1),this.dispatchEvent({type:"markerremoved",marker:marker}),marker.dispatchEvent({type:"removed"})},map-block.Map.prototype.getMarkerByID=function(id){for(var i=0;i<this.markers.length;i++)if(this.markers[i].id==id)return this.markers[i];return null},map-block.Map.prototype.removeMarkerByID=function(id){var marker=this.getMarkerByID(id);marker&&this.removeMarker(marker)},map-block.Map.prototype.addPolygon=function(polygon){if(!(polygon instanceof map-block.Polygon))throw new Error("Argument must be an instance of map-block.Polygon");(polygon.map=this).polygons.push(polygon),this.dispatchEvent({type:"polygonadded",polygon:polygon})},map-block.Map.prototype.deletePolygon=function(polygon){if(!(polygon instanceof map-block.Polygon))throw new Error("Argument must be an instance of map-block.Polygon");if(polygon.map!==this)throw new Error("Wrong map error");polygon.map=null,this.polygons.splice(this.polygons.indexOf(polygon),1),this.dispatchEvent({type:"polygonremoved",polygon:polygon})},map-block.Map.prototype.getPolygonByID=function(id){for(var i=0;i<this.polygons.length;i++)if(this.polygons[i].id==id)return this.polygons[i];return null},map-block.Map.prototype.deletePolygonByID=function(id){var polygon=this.getPolygonByID(id);polygon&&this.deletePolygon(polygon)},map-block.Map.prototype.getPolylineByID=function(id){for(var i=0;i<this.polylines.length;i++)if(this.polylines[i].id==id)return this.polylines[i];return null},map-block.Map.prototype.addPolyline=function(polyline){if(!(polyline instanceof map-block.Polyline))throw new Error("Argument must be an instance of map-block.Polyline");(polyline.map=this).polylines.push(polyline),this.dispatchEvent({type:"polylineadded",polyline:polyline})},map-block.Map.prototype.deletePolyline=function(polyline){if(!(polyline instanceof map-block.Polyline))throw new Error("Argument must be an instance of map-block.Polyline");if(polyline.map!==this)throw new Error("Wrong map error");polyline.map=null,this.polylines.splice(this.polylines.indexOf(polyline),1),this.dispatchEvent({type:"polylineremoved",polyline:polyline})},map-block.Map.prototype.getPolylineByID=function(id){for(var i=0;i<this.polylines.length;i++)if(this.polylines[i].id==id)return this.polylines[i];return null},map-block.Map.prototype.deletePolylineByID=function(id){var polyline=this.getPolylineByID(id);polyline&&this.deletePolyline(polyline)},map-block.Map.prototype.addCircle=function(circle){if(!(circle instanceof map-block.Circle))throw new Error("Argument must be an instance of map-block.Circle");(circle.map=this).circles.push(circle),this.dispatchEvent({type:"circleadded",circle:circle})},map-block.Map.prototype.removeCircle=function(circle){if(!(circle instanceof map-block.Circle))throw new Error("Argument must be an instance of map-block.Circle");if(circle.map!==this)throw new Error("Wrong map error");circle.map=null,this.circles.splice(this.circles.indexOf(circle),1),this.dispatchEvent({type:"circleremoved",circle:circle})},map-block.Map.prototype.getCircleByID=function(id){for(var i=0;i<this.circles.length;i++)if(this.circles[i].id==id)return this.circles[i];return null},map-block.Map.prototype.deleteCircleByID=function(id){var circle=this.getCircleByID(id);circle&&this.deleteCircle(circle)},map-block.Map.prototype.nudge=function(x,y){var pixels=this.latLngToPixels(this.getCenter());if(pixels.x+=parseFloat(x),pixels.y+=parseFloat(y),isNaN(pixels.x)||isNaN(pixels.y))throw new Error("Invalid coordinates supplied");var latLng=this.pixelsToLatLng(pixels);this.setCenter(latLng)},map-block.Map.prototype.onWindowResize=function(event){},map-block.Map.prototype.onElementResized=function(event){},map-block.Map.prototype.onBoundsChanged=function(event){this.trigger("boundschanged"),this.trigger("bounds_changed")},map-block.Map.prototype.onIdle=function(event){$(this.element).trigger("idle")}}),jQuery(function($){map-block.MapsEngineDialog=function(element){var self=this;this.element=element,window.map-blockUnbindSaveReminder&&window.map-blockUnbindSaveReminder(),$(element).show(),$(element).remodal().open(),$(element).find("input:radio").on("change",function(event){$("#map-block-confirm-engine").prop("disabled",!1)}),$("#map-block-confirm-engine").on("click",function(event){self.onButtonClicked(event)})},map-block.MapsEngineDialog.prototype.onButtonClicked=function(event){$(event.target).prop("disabled",!0),$.ajax(map-block.ajaxurl,{method:"POST",data:{action:"map-block_maps_engine_dialog_set_engine",engine:$("[name='map-block_maps_engine']:checked").val()},success:function(response,status,xhr){window.location.reload()}})},$(window).on("load",function(event){var element=$("#map-block-maps-engine-dialog");element.length&&(map-block.settings.map-block_maps_engine_dialog_done||(map-block.mapsEngineDialog=new map-block.MapsEngineDialog(element)))})}),jQuery(function($){map-block.Marker=function(row){var self=this;map-block.assertInstanceOf(this,"Marker"),this.lat="36.778261",this.lng="-119.4179323999",this.address="California",this.title=null,this.description="",this.link="",this.icon="",this.approved=1,this.pic=null,map-block.MapObject.apply(this,arguments),row&&row.heatmap||(row&&this.on("init",function(event){row.position&&this.setPosition(row.position),row.map&&row.map.addMarker(this)}),this.addEventListener("added",function(event){self.onAdded(event)}))},map-block.Marker.prototype=Object.create(map-block.MapObject.prototype),map-block.Marker.prototype.constructor=map-block.Marker,map-block.Marker.getConstructor=function(){switch(map-block.settings.engine){case"open-layers":return map-block.isProVersion()?map-block.OLProMarker:map-block.OLMarker;default:return map-block.isProVersion()?map-block.GoogleProMarker:map-block.GoogleMarker}},map-block.Marker.createInstance=function(row){return new(map-block.Marker.getConstructor())(row)},map-block.Marker.ANIMATION_NONE="0",map-block.Marker.ANIMATION_BOUNCE="1",map-block.Marker.ANIMATION_DROP="2",map-block.Marker.prototype.onAdded=function(event){var self=this;this.addEventListener("click",function(event){self.onClick(event)}),this.addEventListener("mouseover",function(event){self.onMouseOver(event)}),this.addEventListener("select",function(event){self.onSelect(event)}),this.map.settings.marker==this.id&&self.trigger("select")},map-block.Marker.prototype.hidePreviousInteractedInfoWindow=function(){this.map.lastInteractedMarker&&this.map.lastInteractedMarker.infoWindow.close()},map-block.Marker.prototype.openInfoWindow=function(){},map-block.Marker.prototype.onClick=function(event){},map-block.Marker.prototype.onSelect=function(event){this.openInfoWindow()},map-block.Marker.prototype.onMouseOver=function(event){this.map.settings.info_window_open_by==map-block.InfoWindow.OPEN_BY_HOVER&&this.openInfoWindow()},map-block.Marker.prototype.getIcon=function(){return"string"!=typeof(url=map-block.settings.default_marker_icon)?url:url.replace(/^http(s?):/,"");var url},map-block.Marker.prototype.getPosition=function(){return{lat:parseFloat(this.lat),lng:parseFloat(this.lng)}},map-block.Marker.prototype.setPosition=function(latLng){latLng instanceof map-block.LatLng?(this.lat=latLng.lat,this.lng=latLng.lng):(this.lat=parseFloat(latLng.lat),this.lng=parseFloat(latLng.lng))},map-block.Marker.prototype.getAnimation=function(animation){return this.settings.animation},map-block.Marker.prototype.setAnimation=function(animation){this.settings.animation=animation},map-block.Marker.prototype.getVisible=function(visible){},map-block.Marker.prototype.setVisible=function(visible){!visible&&this.infoWindow&&this.infoWindow.close()},map-block.Marker.prototype.setMap=function(map){map?map.addMarker(this):this.map&&this.map.removeMarker(this)},map-block.Marker.prototype.getDraggable=function(){},map-block.Marker.prototype.setDraggable=function(draggable){},map-block.Marker.prototype.setOptions=function(){},map-block.Marker.prototype.panIntoView=function(){if(!this.map)throw new Error("Marker hasn't been added to a map");this.map.setCenter(this.getPosition())},map-block.Marker.prototype.toJSON=function(){var result=map-block.MapObject.prototype.toJSON.call(this),position=this.getPosition();return $.extend(result,{lat:position.lat,lng:position.lng,address:this.address,title:this.title,description:this.description,link:this.link,icon:this.icon,pic:this.pic,approved:this.approved}),result}}),jQuery(function($){map-block.ModernStoreLocatorCircle=function(map_id,settings){var map;map=map-block.isProVersion()?this.map=MYMAP[map_id].map:this.map=MYMAP.map,this.map_id=map_id,this.mapElement=map.element,this.mapSize={width:$(this.mapElement).width(),height:$(this.mapElement).height()},this.initCanvasLayer(),this.settings={center:new map-block.LatLng(0,0),radius:1,color:"#63AFF2",shadowColor:"white",shadowBlur:4,centerRingRadius:10,centerRingLineWidth:3,numInnerRings:9,innerRingLineWidth:1,innerRingFade:!0,numOuterRings:7,ringLineWidth:1,mainRingLineWidth:2,numSpokes:6,spokesStartAngle:Math.PI/2,numRadiusLabels:6,radiusLabelsStartAngle:Math.PI/2,radiusLabelFont:"13px sans-serif",visible:!1},settings&&this.setOptions(settings)},map-block.ModernStoreLocatorCircle.createInstance=function(map,settings){return"google-maps"==map-block.settings.engine?new map-block.GoogleModernStoreLocatorCircle(map,settings):new map-block.OLModernStoreLocatorCircle(map,settings)},map-block.ModernStoreLocatorCircle.prototype.initCanvasLayer=function(){},map-block.ModernStoreLocatorCircle.prototype.onResize=function(event){this.draw()},map-block.ModernStoreLocatorCircle.prototype.onUpdate=function(event){this.draw()},map-block.ModernStoreLocatorCircle.prototype.setOptions=function(options){for(var name in options){var functionName="set"+name.substr(0,1).toUpperCase()+name.substr(1);"function"==typeof this[functionName]?this[functionName](options[name]):this.settings[name]=options[name]}},map-block.ModernStoreLocatorCircle.prototype.getResolutionScale=function(){return window.devicePixelRatio||1},map-block.ModernStoreLocatorCircle.prototype.getCenter=function(){return this.getPosition()},map-block.ModernStoreLocatorCircle.prototype.setCenter=function(value){this.setPosition(value)},map-block.ModernStoreLocatorCircle.prototype.getPosition=function(){return this.settings.center},map-block.ModernStoreLocatorCircle.prototype.setPosition=function(position){this.settings.center=position},map-block.ModernStoreLocatorCircle.prototype.getRadius=function(){return this.settings.radius},map-block.ModernStoreLocatorCircle.prototype.setRadius=function(radius){if(isNaN(radius))throw new Error("Invalid radius");this.settings.radius=radius},map-block.ModernStoreLocatorCircle.prototype.getVisible=function(visible){return this.settings.visible},map-block.ModernStoreLocatorCircle.prototype.setVisible=function(visible){this.settings.visible=visible},map-block.ModernStoreLocatorCircle.prototype.getTransformedRadius=function(km){throw new Error("Abstract function called")},map-block.ModernStoreLocatorCircle.prototype.getContext=function(type){throw new Error("Abstract function called")},map-block.ModernStoreLocatorCircle.prototype.getCanvasDimensions=function(){throw new Error("Abstract function called")},map-block.ModernStoreLocatorCircle.prototype.validateSettings=function(){map-block.isHexColorString(this.settings.color)||(this.settings.color="#63AFF2")},map-block.ModernStoreLocatorCircle.prototype.draw=function(){this.validateSettings();var settings=this.settings,canvasDimensions=this.getCanvasDimensions(),canvasWidth=canvasDimensions.width,canvasHeight=canvasDimensions.height;this.map,this.getResolutionScale();if(context=this.getContext("2d"),context.clearRect(0,0,canvasWidth,canvasHeight),settings.visible){context.shadowColor=settings.shadowColor,context.shadowBlur=settings.shadowBlur,context.setTransform(1,0,0,1,0,0);var scale=this.getScale();context.scale(scale,scale);var offset=this.getWorldOriginOffset();context.translate(offset.x,offset.y);new map-block.LatLng(this.settings.center);var worldPoint=this.getCenterPixels(),rgba=map-block.hexToRgba(settings.color),ringSpacing=this.getTransformedRadius(settings.radius)/(settings.numInnerRings+1);context.strokeStyle=settings.color,context.lineWidth=1/scale*settings.centerRingLineWidth,context.beginPath(),context.arc(worldPoint.x,worldPoint.y,this.getTransformedRadius(settings.centerRingRadius)/scale,0,2*Math.PI),context.stroke(),context.closePath();var end,radius=this.getTransformedRadius(settings.radius)+ringSpacing*settings.numOuterRings+1,grad=context.createRadialGradient(0,0,0,0,0,radius),start=(rgba=map-block.hexToRgba(settings.color),map-block.rgbaToString(rgba));rgba.a=0,end=map-block.rgbaToString(rgba),grad.addColorStop(0,start),grad.addColorStop(1,end),context.save(),context.translate(worldPoint.x,worldPoint.y),context.strokeStyle=grad,context.lineWidth=2/scale;for(var i=0;i<settings.numSpokes;i++)spokeAngle=settings.spokesStartAngle+2*Math.PI*(i/settings.numSpokes),x=Math.cos(spokeAngle)*radius,y=Math.sin(spokeAngle)*radius,context.setLineDash([2/scale,15/scale]),context.beginPath(),context.moveTo(0,0),context.lineTo(x,y),context.stroke();context.setLineDash([]),context.restore(),context.lineWidth=1/scale*settings.innerRingLineWidth;for(i=1;i<=settings.numInnerRings;i++){radius=i*ringSpacing;settings.innerRingFade&&(rgba.a=1-(i-1)/settings.numInnerRings),context.strokeStyle=map-block.rgbaToString(rgba),context.beginPath(),context.arc(worldPoint.x,worldPoint.y,radius,0,2*Math.PI),context.stroke(),context.closePath()}context.strokeStyle=settings.color,context.lineWidth=1/scale*settings.centerRingLineWidth,context.beginPath(),context.arc(worldPoint.x,worldPoint.y,this.getTransformedRadius(settings.radius),0,2*Math.PI),context.stroke(),context.closePath();for(radius=radius+ringSpacing,i=0;i<settings.numOuterRings;i++)settings.innerRingFade&&(rgba.a=1-i/settings.numOuterRings),context.strokeStyle=map-block.rgbaToString(rgba),context.beginPath(),context.arc(worldPoint.x,worldPoint.y,radius,0,2*Math.PI),context.stroke(),context.closePath(),radius+=ringSpacing;if(0<settings.numRadiusLabels){var m,x,y;radius=this.getTransformedRadius(settings.radius);(m=settings.radiusLabelFont.match(/(\d+)px/))&&parseInt(m[1])/2*1.1/scale,context.font=settings.radiusLabelFont,context.textAlign="center",context.textBaseline="middle",context.fillStyle=settings.color,context.save(),context.translate(worldPoint.x,worldPoint.y);for(i=0;i<settings.numRadiusLabels;i++){var spokeAngle,width,textAngle=(spokeAngle=settings.radiusLabelsStartAngle+2*Math.PI*(i/settings.numRadiusLabels))+Math.PI/2,text=settings.radiusString;0<Math.sin(spokeAngle)&&(textAngle-=Math.PI),x=Math.cos(spokeAngle)*radius,y=Math.sin(spokeAngle)*radius,context.save(),context.translate(x,y),context.rotate(textAngle),context.scale(1/scale,1/scale),width=context.measureText(text).width,height=width/2,context.clearRect(-width,-height,2*width,2*height),context.fillText(settings.radiusString,0,0),context.restore()}context.restore()}}}}),jQuery(function($){map-block.ModernStoreLocator=function(map_id){var original,self=this;if(map-block.assertInstanceOf(this,"ModernStoreLocator"),(original=map-block.isProVersion()?$(".map-block_sl_search_button[mid='"+map_id+"']").closest(".map-block_sl_main_div"):$(".map-block_sl_search_button").closest(".map-block_sl_main_div")).length){this.element=$("<div class='map-block-modern-store-locator'><div class='map-block-inner map-block-modern-hover-opaque'/></div>")[0];var addressInput,inner=$(this.element).find(".map-block-inner"),titleSearch=$(original).find("[id='nameInput_"+map_id+"']");if(titleSearch.length){var placeholder=map-blockaps_localize[map_id].other_settings.store_locator_name_string;placeholder&&placeholder.length&&titleSearch.attr("placeholder",placeholder),inner.append(titleSearch)}addressInput=map-block.isProVersion()?$(original).find(".addressInput"):$(original).find("#addressInput"),map-blockaps_localize[map_id].other_settings.store_locator_query_string&&map-blockaps_localize[map_id].other_settings.store_locator_query_string.length&&addressInput.attr("placeholder",map-blockaps_localize[map_id].other_settings.store_locator_query_string),inner.append(addressInput),inner.append($(original).find("select.map-block_sl_radius_select")),this.searchButton=$(original).find(".map-block_sl_search_button"),inner.append(this.searchButton),this.resetButton=$(original).find(".map-block_sl_reset_button_div"),inner.append(this.resetButton),this.resetButton.on("click",function(event){resetLocations(map_id)}),this.resetButton.hide(),map-block.isProVersion()&&(this.searchButton.on("click",function(event){0!=$("addressInput_"+map_id).val()&&(self.searchButton.hide(),self.resetButton.show())}),this.resetButton.on("click",function(event){self.resetButton.hide(),self.searchButton.show()})),inner.append($("#map-block_distance_type_"+map_id));var container=$(original).find(".map-block_cat_checkbox_holder"),items=($(container).children("ul"),$(container).find("li")),numCategories=0,icons=[];items.each(function(index,el){var id=$(el).attr("class").match(/\d+/);for(var category_id in map-block_category_data)if(id==category_id){var src=map-block_category_data[category_id].image,icon=$('<div class="map-block-chip-icon"/>');icon.css({"background-image":"url('"+src+"')",width:$("#map-block_cat_checkbox_"+category_id+" + label").height()+"px"}),icons.push(icon),null!=src&&""!=src&&$("#map-block_cat_checkbox_"+category_id+" + label").prepend(icon),numCategories++;break}}),$(this.element).append(container),numCategories&&(this.optionsButton=$('<span class="map-block_store_locator_options_button"><i class="fas fa-list"></i></span>'),$(this.searchButton).before(this.optionsButton)),setInterval(function(){icons.forEach(function(icon){var height=$(icon).height();$(icon).css({width:height+"px"}),$(icon).closest("label").css({"padding-left":height+8+"px"})}),$(container).css("width",$(self.element).find(".map-block-inner").outerWidth()+"px")},1e3),$(this.element).find(".map-block_store_locator_options_button").on("click",function(event){container.hasClass("map-block-open")?container.removeClass("map-block-open"):container.addClass("map-block-open")}),$(original).remove(),$(this.element).find("input, select").on("focus",function(){$(inner).addClass("active")}),$(this.element).find("input, select").on("blur",function(){$(inner).removeClass("active")})}},map-block.ModernStoreLocator.createInstance=function(map_id){return"google-maps"==map-block.settings.engine?new map-block.GoogleModernStoreLocator(map_id):new map-block.OLModernStoreLocator(map_id)}}),jQuery(function($){map-block.Polygon=function(row,enginePolygon){map-block.assertInstanceOf(this,"Polygon"),this.paths=null,this.title=null,this.name=null,this.link=null,map-block.MapObject.apply(this,arguments)},map-block.Polygon.prototype=Object.create(map-block.MapObject.prototype),map-block.Polygon.prototype.constructor=map-block.Polygon,map-block.Polygon.getConstructor=function(){switch(map-block.settings.engine){case"open-layers":return map-block.isProVersion()?map-block.OLProPolygon:map-block.OLPolygon;default:return map-block.isProVersion()?map-block.GoogleProPolygon:map-block.GooglePolygon}},map-block.Polygon.createInstance=function(row,engineObject){return new(map-block.Polygon.getConstructor())(row,engineObject)},map-block.Polygon.prototype.toJSON=function(){var result=map-block.MapObject.prototype.toJSON.call(this);return $.extend(result,{name:this.name,title:this.title,link:this.link}),result}}),jQuery(function($){map-block.Polyline=function(row,googlePolyline){map-block.assertInstanceOf(this,"Polyline"),this.title=null,map-block.MapObject.apply(this,arguments)},map-block.Polyline.prototype=Object.create(map-block.MapObject.prototype),map-block.Polyline.prototype.constructor=map-block.Polyline,map-block.Polyline.getConstructor=function(){switch(map-block.settings.engine){case"open-layers":return map-block.OLPolyline;default:return map-block.GooglePolyline}},map-block.Polyline.createInstance=function(row,engineObject){return new(map-block.Polyline.getConstructor())(row,engineObject)},map-block.Polyline.prototype.getPoints=function(){return this.toJSON().points},map-block.Polyline.prototype.toJSON=function(){var result=map-block.MapObject.prototype.toJSON.call(this);return result.title=this.title,result}}),jQuery(function($){map-block.RestAPI=function(){map-block.RestAPI.URL=map-block.resturl},map-block.RestAPI.createInstance=function(){return new map-block.RestAPI},map-block.RestAPI.prototype.call=function(route,params){if("string"!=typeof route||!route.match(/^\//))throw new Error("Invalid route");map-block.RestAPI.URL.match(/\/$/)&&(route=route.replace(/^\//,"")),$.ajax(map-block.RestAPI.URL+route,params)}}),jQuery(function($){function validateParts(parts){for(var i=0;i<parts.length;++i)if(x=parts[i],!/^\d+$/.test(x))return!1;var x;return!0}map-block.Version=function(){},map-block.Version.compare=function(v1,v2){var v1parts=v1.split("."),v2parts=v2.split(".");if(!validateParts(v1parts)||!validateParts(v2parts))return NaN;for(var i=0;i<v1parts.length;++i){if(v2parts.length===i)return 1;if(v1parts[i]!==v2parts[i])return v1parts[i]>v2parts[i]?1:-1}return v1parts.length!=v2parts.length?-1:0}}),jQuery(function($){map-block.Integration={},map-block.integrationModules={}}),jQuery(function($){if(wp&&wp.i18n&&wp.blocks){var __=wp.i18n.__,registerBlockType=wp.blocks.registerBlockType,_wp$editor=wp.editor,InspectorControls=_wp$editor.InspectorControls,_wp$components=(_wp$editor.BlockControls,wp.components),Dashicon=_wp$components.Dashicon,PanelBody=(_wp$components.Toolbar,_wp$components.Button,_wp$components.Tooltip,_wp$components.PanelBody);_wp$components.TextareaControl,_wp$components.TextControl,_wp$components.RichText;map-block.Integration.Gutenberg=function(){registerBlockType("gutenberg-map-block/block",this.getBlockDefinition())},map-block.Integration.Gutenberg.prototype.getBlockTitle=function(){return __("Map Block")},map-block.Integration.Gutenberg.prototype.getBlockInspectorControls=function(props){return React.createElement(InspectorControls,{key:"inspector"},React.createElement(PanelBody,{title:__("Map Settings")}))},map-block.Integration.Gutenberg.prototype.getBlockAttributes=function(){return{}},map-block.Integration.Gutenberg.prototype.getBlockDefinition=function(props){var _this=this;return{title:__("Map Block"),description:__("The easiest to use Google Maps plugin! Create custom Google Maps with high quality markers containing locations, descriptions, images and links. Add your customized map to your WordPress posts and/or pages quickly and easily with the supplied shortcode. No fuss."),category:"common",icon:"location-alt",keywords:[__("Map"),__("Maps"),__("Google")],attributes:this.getBlockAttributes(),edit:function(props){return[!!props.isSelected&&_this.getBlockInspectorControls(props),React.createElement("div",{className:props.className+" map-block-gutenberg-block"},React.createElement(Dashicon,{icon:"location-alt"}),React.createElement("span",{class:"map-block-gutenberg-block-title"},__("Map Block")))]},save:function(props){return null}}},map-block.Integration.Gutenberg.getConstructor=function(){return map-block.Integration.Gutenberg},map-block.Integration.Gutenberg.createInstance=function(){return new(map-block.Integration.Gutenberg.getConstructor())},map-block.isProVersion()||(map-block.integrationModules.gutenberg=map-block.Integration.Gutenberg.createInstance())}}),jQuery(function($){map-block.GoogleUICompatibility=function(){if(!(navigator.vendor&&-1<navigator.vendor.indexOf("Apple")&&navigator.userAgent&&-1==navigator.userAgent.indexOf("CriOS")&&-1==navigator.userAgent.indexOf("FxiOS"))){var style=$("<style id='map-block-google-ui-compatiblity-fix'/>");style.html(".map-block_map img:not(button img) { padding:0 !important; }"),$(document.head).append(style)}},map-block.googleUICompatibility=new map-block.GoogleUICompatibility}),jQuery(function($){map-block.GoogleCircle=function(options,googleCircle){var self=this;if(map-block.Circle.call(this,options,googleCircle),googleCircle?this.googleCircle=googleCircle:(this.googleCircle=new google.maps.Circle,this.googleCircle.map-blockCircle=this),google.maps.event.addListener(this.googleCircle,"click",function(){self.dispatchEvent({type:"click"})}),options){var googleOptions={};delete(googleOptions=$.extend({},options)).map,delete googleOptions.center,options.center&&(googleOptions.center=new google.maps.LatLng({lat:options.center.lat,lng:options.center.lng})),this.googleCircle.setOptions(googleOptions),options.map&&options.map.addCircle(this)}},map-block.GoogleCircle.prototype=Object.create(map-block.Circle.prototype),map-block.GoogleCircle.prototype.constructor=map-block.GoogleCircle}),jQuery(function($){map-block.GoogleGeocoder=function(){},map-block.GoogleGeocoder.prototype=Object.create(map-block.Geocoder.prototype),map-block.GoogleGeocoder.prototype.constructor=map-block.GoogleGeocoder,map-block.GoogleGeocoder.prototype.getLatLngFromAddress=function(options,callback){if(!options||!options.address)throw new Error("No address specified");if(map-block.isLatLngString(options.address))return map-block.Geocoder.prototype.getLatLngFromAddress.call(this,options,callback);options.country&&(options.componentRestrictions={country:options.country}),(new google.maps.Geocoder).geocode(options,function(results,status){if(status==google.maps.GeocoderStatus.OK){var location=results[0].geometry.location,latLng={lat:location.lat(),lng:location.lng()};callback(results=[{geometry:{location:latLng},latLng:latLng,lat:latLng.lat,lng:latLng.lng}],map-block.Geocoder.SUCCESS)}else{var nativeStatus=map-block.Geocoder.FAIL;status==google.maps.GeocoderStatus.ZERO_RESULTS&&(nativeStatus=map-block.Geocoder.ZERO_RESULTS),callback(null,nativeStatus)}})},map-block.GoogleGeocoder.prototype.getAddressFromLatLng=function(options,callback){if(!options||!options.latLng)throw new Error("No latLng specified");var latLng=new map-block.LatLng(options.latLng),geocoder=new google.maps.Geocoder;delete(options=$.extend(options,{location:{lat:latLng.lat,lng:latLng.lng}})).latLng,geocoder.geocode(options,function(results,status){"OK"!==status&&callback(null,map-block.Geocoder.FAIL),results&&results.length||callback([],map-block.Geocoder.NO_RESULTS),callback([results[0].formatted_address],map-block.Geocoder.SUCCESS)})}}),jQuery(function($){var Parent;map-block.GoogleInfoWindow=function(mapObject){Parent.call(this,mapObject),this.setMapObject(mapObject)},Parent=map-block.isProVersion()?map-block.ProInfoWindow:map-block.InfoWindow,map-block.GoogleInfoWindow.prototype=Object.create(Parent.prototype),map-block.GoogleInfoWindow.prototype.constructor=map-block.GoogleInfoWindow,map-block.GoogleInfoWindow.prototype.setMapObject=function(mapObject){mapObject instanceof map-block.Marker?this.googleObject=mapObject.googleMarker:mapObject instanceof map-block.Polygon?this.googleObject=mapObject.googlePolygon:mapObject instanceof map-block.Polyline&&(this.googleObject=mapObject.googlePolyline)},map-block.GoogleInfoWindow.prototype.createGoogleInfoWindow=function(){this.googleInfoWindow||(this.googleInfoWindow=new google.maps.InfoWindow)},map-block.GoogleInfoWindow.prototype.open=function(map,mapObject){return!!Parent.prototype.open.call(this,map,mapObject)&&(this.createGoogleInfoWindow(),this.setMapObject(mapObject),this.googleInfoWindow.open(this.mapObject.map.googleMap,this.googleObject),this.content&&this.googleInfoWindow.setContent(this.content),!0)},map-block.GoogleInfoWindow.prototype.close=function(){this.googleInfoWindow&&(map-block.InfoWindow.prototype.close.call(this),this.googleInfoWindow.close())},map-block.GoogleInfoWindow.prototype.setContent=function(html){Parent.prototype.setContent.call(this,html),this.content=html,this.createGoogleInfoWindow(),this.googleInfoWindow.setContent(html)},map-block.GoogleInfoWindow.prototype.setOptions=function(options){Parent.prototype.setOptions.call(this,options),this.createGoogleInfoWindow(),this.googleInfoWindow.setOptions(options)}}),jQuery(function($){var Parent;map-block.GoogleMap=function(element,options){var self=this;if(Parent.call(this,element,options),!window.google){var status=map-block.googleAPIStatus,message="Google API not loaded";if(status&&status.message&&(message+=" - "+status.message),"USER_CONSENT_NOT_GIVEN"==status.code)return;throw $(element).html("<div class='notice notice-error'><p>"+map-block.localized_strings.google_api_not_loaded+"<pre>"+message+"</pre></p></div>"),new Error(message)}this.loadGoogleMap(),options&&this.setOptions(options),google.maps.event.addListener(this.googleMap,"click",function(event){var map-blockEvent=new map-block.Event("click");map-blockEvent.latLng={lat:event.latLng.lat(),lng:event.latLng.lng()},self.dispatchEvent(map-blockEvent)}),google.maps.event.addListener(this.googleMap,"rightclick",function(event){var map-blockEvent=new map-block.Event("rightclick");map-blockEvent.latLng={lat:event.latLng.lat(),lng:event.latLng.lng()},self.dispatchEvent(map-blockEvent)}),google.maps.event.addListener(this.googleMap,"dragend",function(event){self.dispatchEvent("dragend")}),google.maps.event.addListener(this.googleMap,"zoom_changed",function(event){self.dispatchEvent("zoom_changed"),self.dispatchEvent("zoomchanged")}),google.maps.event.addListener(this.googleMap,"idle",function(event){self.onIdle(event)}),map-block.isProVersion()||(this.dispatchEvent("created"),map-block.events.dispatchEvent({type:"mapcreated",map:this}))},map-block.isProVersion()?(Parent=map-block.ProMap,map-block.GoogleMap.prototype=Object.create(map-block.ProMap.prototype)):(Parent=map-block.Map,map-block.GoogleMap.prototype=Object.create(map-block.Map.prototype)),map-block.GoogleMap.prototype.constructor=map-block.GoogleMap,map-block.GoogleMap.prototype.loadGoogleMap=function(){var self=this,options=this.settings.toGoogleMapsOptions();this.googleMap=new google.maps.Map(this.engineElement,options),google.maps.event.addListener(this.googleMap,"bounds_changed",function(){self.onBoundsChanged()}),1==this.settings.bicycle&&this.enableBicycleLayer(!0),1==this.settings.traffic&&this.enableTrafficLayer(!0),1==this.settings.transport&&this.enablePublicTransportLayer(!0),this.showPointsOfInterest(this.settings.show_points_of_interest),$(this.engineElement).append($(this.element).find(".map-block-loader"))},map-block.GoogleMap.prototype.setOptions=function(options){Parent.prototype.setOptions.call(this,options),this.googleMap.setOptions(this.settings.toGoogleMapsOptions());var clone=$.extend({},options);(clone.center instanceof map-block.LatLng||"object"==typeof clone.center)&&(clone.center={lat:parseFloat(clone.center.lat),lng:parseFloat(clone.center.lng)}),this.googleMap.setOptions(clone)},map-block.GoogleMap.prototype.addMarker=function(marker){marker.googleMarker.setMap(this.googleMap),Parent.prototype.addMarker.call(this,marker)},map-block.GoogleMap.prototype.removeMarker=function(marker){marker.googleMarker.setMap(null),Parent.prototype.removeMarker.call(this,marker)},map-block.GoogleMap.prototype.addPolygon=function(polygon){polygon.googlePolygon.setMap(this.googleMap),Parent.prototype.addPolygon.call(this,polygon)},map-block.GoogleMap.prototype.removePolygon=function(polygon){polygon.googlePolygon.setMap(null),Parent.prototype.removePolygon.call(this,polygon)},map-block.GoogleMap.prototype.addPolyline=function(polyline){polyline.googlePolyline.setMap(this.googleMap),Parent.prototype.addPolyline.call(this,polyline)},map-block.GoogleMap.prototype.removePolyline=function(polyline){polyline.googlePolyline.setMap(null),Parent.prototype.removePolyline.call(this,polyline)},map-block.GoogleMap.prototype.addCircle=function(circle){circle.googleCircle.setMap(this.googleMap),Parent.prototype.addCircle.call(this,circle)},map-block.GoogleMap.prototype.removeCircle=function(circle){circle.googleCircle.setMap(null),Parent.prototype.removeCircle.call(this,circle)},map-block.GoogleMap.prototype.getCenter=function(){var latLng=this.googleMap.getCenter();return{lat:latLng.lat(),lng:latLng.lng()}},map-block.GoogleMap.prototype.setCenter=function(latLng){map-block.Map.prototype.setCenter.call(this,latLng),latLng instanceof map-block.LatLng?this.googleMap.setCenter({lat:latLng.lat,lng:latLng.lng}):this.googleMap.setCenter(latLng)},map-block.GoogleMap.prototype.panTo=function(latLng){latLng instanceof map-block.LatLng?this.googleMap.panTo({lat:latLng.lat,lng:latLng.lng}):this.googleMap.panTo(latLng)},map-block.GoogleMap.prototype.getZoom=function(){return this.googleMap.getZoom()},map-block.GoogleMap.prototype.setZoom=function(value){if(isNaN(value))throw new Error("Value must not be NaN");return this.googleMap.setZoom(value)},map-block.GoogleMap.prototype.getBounds=function(){var bounds=this.googleMap.getBounds(),northEast=bounds.getNorthEast(),southWest=bounds.getSouthWest();return{topLeft:{lat:northEast.lat(),lng:southWest.lng()},bottomRight:{lat:southWest.lat(),lng:northEast.lng()}}},map-block.GoogleMap.prototype.fitBounds=function(southWest,northEast){southWest instanceof map-block.LatLng&&(southWest={lat:southWest.lat,lng:southWest.lng}),northEast instanceof map-block.LatLng&&(northEast={lat:northEast.lat,lng:northEast.lng}),this.googleMap.fitBounds(southWest,northEast)},map-block.GoogleMap.prototype.fitBoundsToVisibleMarkers=function(){for(var bounds=new google.maps.LatLngBounds,i=0;i<this.markers.length;i++)markers[i].getVisible()&&bounds.extend(markers[i].getPosition());this.googleMap.fitBounds(bounds)},map-block.GoogleMap.prototype.enableBicycleLayer=function(enable){this.bicycleLayer||(this.bicycleLayer=new google.maps.BicyclingLayer),this.bicycleLayer.setMap(enable?this.googleMap:null)},map-block.GoogleMap.prototype.enableTrafficLayer=function(enable){this.trafficLayer||(this.trafficLayer=new google.maps.TrafficLayer),this.trafficLayer.setMap(enable?this.googleMap:null)},map-block.GoogleMap.prototype.enablePublicTransportLayer=function(enable){this.publicTransportLayer||(this.publicTransportLayer=new google.maps.TransitLayer),this.publicTransportLayer.setMap(enable?this.googleMap:null)},map-block.GoogleMap.prototype.showPointsOfInterest=function(show){var text=$("textarea[name='theme_data']").val();if(text){var styles=JSON.parse(text);styles.push({featureType:"poi",stylers:[{visibility:show?"on":"off"}]}),this.googleMap.setOptions({styles:styles})}},map-block.GoogleMap.prototype.getMinZoom=function(){return parseInt(this.settings.min_zoom)},map-block.GoogleMap.prototype.setMinZoom=function(value){this.googleMap.setOptions({minZoom:value,maxZoom:this.getMaxZoom()})},map-block.GoogleMap.prototype.getMaxZoom=function(){return parseInt(this.settings.max_zoom)},map-block.GoogleMap.prototype.setMaxZoom=function(value){this.googleMap.setOptions({minZoom:this.getMinZoom(),maxZoom:value})},map-block.GoogleMap.prototype.latLngToPixels=function(latLng){var map=this.googleMap,nativeLatLng=new google.maps.LatLng({lat:parseFloat(latLng.lat),lng:parseFloat(latLng.lng)}),topRight=map.getProjection().fromLatLngToPoint(map.getBounds().getNorthEast()),bottomLeft=map.getProjection().fromLatLngToPoint(map.getBounds().getSouthWest()),scale=Math.pow(2,map.getZoom()),worldPoint=map.getProjection().fromLatLngToPoint(nativeLatLng);return{x:(worldPoint.x-bottomLeft.x)*scale,y:(worldPoint.y-topRight.y)*scale}},map-block.GoogleMap.prototype.pixelsToLatLng=function(x,y){null==y&&("x"in x&&"y"in x?(y=x.y,x=x.x):console.warn("Y coordinate undefined in pixelsToLatLng (did you mean to pass 2 arguments?)"));var map=this.googleMap,topRight=map.getProjection().fromLatLngToPoint(map.getBounds().getNorthEast()),bottomLeft=map.getProjection().fromLatLngToPoint(map.getBounds().getSouthWest()),scale=Math.pow(2,map.getZoom()),worldPoint=new google.maps.Point(x/scale+bottomLeft.x,y/scale+topRight.y),latLng=map.getProjection().fromPointToLatLng(worldPoint);return{lat:latLng.lat(),lng:latLng.lng()}},map-block.GoogleMap.prototype.onElementResized=function(event){this.googleMap&&google.maps.event.trigger(this.googleMap,"resize")}}),jQuery(function($){var Parent;map-block.GoogleMarker=function(row){var self=this;Parent.call(this,row);var settings={};if(row)for(var name in row)row[name]instanceof map-block.LatLng?settings[name]=row[name].toGoogleLatLng():row[name]instanceof map-block.Map||(settings[name]=row[name]);this.googleMarker=new google.maps.Marker(settings),(this.googleMarker.map-blockMarker=this).googleMarker.setPosition(new google.maps.LatLng({lat:parseFloat(this.lat),lng:parseFloat(this.lng)})),this.googleMarker.setLabel(this.settings.label),this.animation&&this.googleMarker.setAnimation(this.animation),google.maps.event.addListener(this.googleMarker,"click",function(){self.dispatchEvent("click"),self.dispatchEvent("select")}),google.maps.event.addListener(this.googleMarker,"mouseover",function(){self.dispatchEvent("mouseover")}),google.maps.event.addListener(this.googleMarker,"dragend",function(){var googleMarkerPosition=self.googleMarker.getPosition();self.setPosition({lat:googleMarkerPosition.lat(),lng:googleMarkerPosition.lng()}),self.dispatchEvent({type:"dragend",latLng:self.getPosition()})}),this.trigger("init")},Parent=map-block.isProVersion()?map-block.ProMarker:map-block.Marker,map-block.GoogleMarker.prototype=Object.create(Parent.prototype),map-block.GoogleMarker.prototype.constructor=map-block.GoogleMarker,map-block.GoogleMarker.prototype.setLabel=function(label){label?(this.googleMarker.setLabel({text:label}),this.googleMarker.getIcon()||this.googleMarker.setIcon(map-block.settings.default_marker_icon)):this.googleMarker.setLabel(null)},map-block.GoogleMarker.prototype.setPosition=function(latLng){Parent.prototype.setPosition.call(this,latLng),this.googleMarker.setPosition({lat:this.lat,lng:this.lng})},map-block.GoogleMarker.prototype.setOffset=function(x,y){var params,self=this,icon=this.googleMarker.getIcon(),img=new Image;params="string"==typeof icon?{url:icon}:icon,img.onload=function(){var defaultAnchor_x=img.width/2,defaultAnchor_y=img.height;params.anchor=new google.maps.Point(defaultAnchor_x-x,defaultAnchor_y-y),self.googleMarker.setIcon(params)},img.src=params.url},map-block.GoogleMarker.prototype.setOptions=function(options){this.googleMarker.setOptions(options)},map-block.GoogleMarker.prototype.setAnimation=function(animation){Parent.prototype.setAnimation.call(this,animation),this.googleMarker.setAnimation(animation)},map-block.GoogleMarker.prototype.setVisible=function(visible){Parent.prototype.setVisible.call(this,visible),this.googleMarker.setVisible(visible)},map-block.GoogleMarker.prototype.setDraggable=function(draggable){this.googleMarker.setDraggable(draggable)}}),jQuery(function($){map-block.GoogleModernStoreLocatorCircle=function(map,settings){var self=this;map-block.ModernStoreLocatorCircle.call(this,map,settings),this.intervalID=setInterval(function(){var mapSize={width:$(self.mapElement).width(),height:$(self.mapElement).height()};mapSize.width==self.mapSize.width&&mapSize.height==self.mapSize.height||(self.canvasLayer.resize_(),self.canvasLayer.draw(),self.mapSize=mapSize)},1e3),$(document).bind("webkitfullscreenchange mozfullscreenchange fullscreenchange",function(){self.canvasLayer.resize_(),self.canvasLayer.draw()})},map-block.GoogleModernStoreLocatorCircle.prototype=Object.create(map-block.ModernStoreLocatorCircle.prototype),map-block.GoogleModernStoreLocatorCircle.prototype.constructor=map-block.GoogleModernStoreLocatorCircle,map-block.GoogleModernStoreLocatorCircle.prototype.initCanvasLayer=function(){var self=this;this.canvasLayer&&(this.canvasLayer.setMap(null),this.canvasLayer.setAnimate(!1)),this.canvasLayer=new CanvasLayer({map:this.map.googleMap,resizeHandler:function(event){self.onResize(event)},updateHandler:function(event){self.onUpdate(event)},animate:!0,resolutionScale:this.getResolutionScale()})},map-block.GoogleModernStoreLocatorCircle.prototype.setOptions=function(options){map-block.ModernStoreLocatorCircle.prototype.setOptions.call(this,options),this.canvasLayer.scheduleUpdate()},map-block.GoogleModernStoreLocatorCircle.prototype.setPosition=function(position){map-block.ModernStoreLocatorCircle.prototype.setPosition.call(this,position),this.canvasLayer.scheduleUpdate()},map-block.GoogleModernStoreLocatorCircle.prototype.setRadius=function(radius){map-block.ModernStoreLocatorCircle.prototype.setRadius.call(this,radius),this.canvasLayer.scheduleUpdate()},map-block.GoogleModernStoreLocatorCircle.prototype.getTransformedRadius=function(km){var spherical=google.maps.geometry.spherical,center=this.settings.center,equator=new map-block.LatLng({lat:0,lng:0}),latitude=new map-block.LatLng({lat:center.lat,lng:0}),offsetAtEquator=spherical.computeOffset(equator.toGoogleLatLng(),1e3*km,90),result=.006395*km*(spherical.computeOffset(latitude.toGoogleLatLng(),1e3*km,90).lng()/offsetAtEquator.lng());if(isNaN(result))throw new Error("here");return result},map-block.GoogleModernStoreLocatorCircle.prototype.getCanvasDimensions=function(){return{width:this.canvasLayer.canvas.width,height:this.canvasLayer.canvas.height}},map-block.GoogleModernStoreLocatorCircle.prototype.getWorldOriginOffset=function(){var position=this.map.googleMap.getProjection().fromLatLngToPoint(this.canvasLayer.getTopLeft());return{x:-position.x,y:-position.y}},map-block.GoogleModernStoreLocatorCircle.prototype.getCenterPixels=function(){var center=new map-block.LatLng(this.settings.center);return this.map.googleMap.getProjection().fromLatLngToPoint(center.toGoogleLatLng())},map-block.GoogleModernStoreLocatorCircle.prototype.getContext=function(type){return this.canvasLayer.canvas.getContext("2d")},map-block.GoogleModernStoreLocatorCircle.prototype.getScale=function(){return Math.pow(2,this.map.getZoom())*this.getResolutionScale()},map-block.GoogleModernStoreLocatorCircle.prototype.setVisible=function(visible){map-block.ModernStoreLocatorCircle.prototype.setVisible.call(this,visible),this.canvasLayer.scheduleUpdate()},map-block.GoogleModernStoreLocatorCircle.prototype.destroy=function(){this.canvasLayer.setMap(null),this.canvasLayer=null,clearInterval(this.intervalID)}}),jQuery(function($){map-block.GoogleModernStoreLocator=function(map_id){map-block.ModernStoreLocator.call(this,map_id),(map-block.isProVersion()?MYMAP[map_id].map.googleMap:MYMAP.map.googleMap).controls[google.maps.ControlPosition.TOP_CENTER].push(this.element)},map-block.GoogleModernStoreLocator.prototype=Object.create(map-block.ModernStoreLocator.prototype),map-block.GoogleModernStoreLocator.prototype.constructor=map-block.GoogleModernStoreLocator}),jQuery(function($){var Parent;map-block.GooglePolygon=function(row,googlePolygon){var self=this;if(Parent.call(this,row,googlePolygon),googlePolygon)this.googlePolygon=googlePolygon;else if(this.googlePolygon=new google.maps.Polygon(this.settings),row&&row.points){var paths=this.parseGeometry(row.points);this.googlePolygon.setOptions({paths:paths})}this.googlePolygon.map-blockPolygon=this,google.maps.event.addListener(this.googlePolygon,"click",function(){self.dispatchEvent({type:"click"})})},Parent=map-block.isProVersion()?map-block.ProPolygon:map-block.Polygon,map-block.GooglePolygon.prototype=Object.create(Parent.prototype),map-block.GooglePolygon.prototype.constructor=map-block.GooglePolygon,map-block.GooglePolygon.prototype.getEditable=function(){return this.googlePolygon.getOptions().editable},map-block.GooglePolygon.prototype.setEditable=function(value){this.googlePolygon.setOptions({editable:value})},map-block.GooglePolygon.prototype.toJSON=function(){var result=map-block.Polygon.prototype.toJSON.call(this);result.points=[];for(var path=this.googlePolygon.getPath(),i=0;i<path.getLength();i++){var latLng=path.getAt(i);result.points.push({lat:latLng.lat(),lng:latLng.lng()})}return result}}),jQuery(function($){map-block.GooglePolyline=function(row,googlePolyline){var self=this;if(map-block.Polyline.call(this,row,googlePolyline),googlePolyline)this.googlePolyline=googlePolyline;else if(this.googlePolyline=new google.maps.Polyline(this.settings),this.googlePolyline.map-blockPolyline=this,row&&row.points){var path=this.parseGeometry(row.points);this.setPoints(path)}google.maps.event.addListener(this.googlePolyline,"click",function(){self.dispatchEvent({type:"click"})})},map-block.GooglePolyline.prototype=Object.create(map-block.Polyline.prototype),map-block.GooglePolyline.prototype.constructor=map-block.GooglePolyline,map-block.GooglePolyline.prototype.setEditable=function(value){this.googlePolyline.setOptions({editable:value})},map-block.GooglePolyline.prototype.setPoints=function(points){this.googlePolyline.setOptions({path:points})},map-block.GooglePolyline.prototype.toJSON=function(){var result=map-block.Polyline.prototype.toJSON.call(this);result.points=[];for(var path=this.googlePolyline.getPath(),i=0;i<path.getLength();i++){var latLng=path.getAt(i);result.points.push({lat:latLng.lat(),lng:latLng.lng()})}return result}}),jQuery(function($){"google-maps"==map-block.settings.engine&&(map-block.googleAPIStatus&&"USER_CONSENT_NOT_GIVEN"==map-block.googleAPIStatus.code||(map-block.GoogleVertexContextMenu=function(mapEditPage){var self=this;this.mapEditPage=mapEditPage,this.element=document.createElement("div"),this.element.className="map-block-vertex-context-menu",this.element.innerHTML="Delete",google.maps.event.addDomListener(this.element,"click",function(event){return self.removeVertex(),event.preventDefault(),event.stopPropagation(),!1})},map-block.GoogleVertexContextMenu.prototype=new google.maps.OverlayView,map-block.GoogleVertexContextMenu.prototype.onAdd=function(){var self=this,map=this.getMap();this.getPanes().floatPane.appendChild(this.element),this.divListener=google.maps.event.addDomListener(map.getDiv(),"mousedown",function(e){e.target!=self.element&&self.close()},!0)},map-block.GoogleVertexContextMenu.prototype.onRemove=function(){google.maps.event.removeListener(this.divListener),this.element.parentNode.removeChild(this.element),this.set("position"),this.set("path"),this.set("vertex")},map-block.GoogleVertexContextMenu.prototype.open=function(map,path,vertex){this.set("position",path.getAt(vertex)),this.set("path",path),this.set("vertex",vertex),this.setMap(map),this.draw()},map-block.GoogleVertexContextMenu.prototype.close=function(){this.setMap(null)},map-block.GoogleVertexContextMenu.prototype.draw=function(){var position=this.get("position"),projection=this.getProjection();if(position&&projection){var point=projection.fromLatLngToDivPixel(position);this.element.style.top=point.y+"px",this.element.style.left=point.x+"px"}},map-block.GoogleVertexContextMenu.prototype.removeVertex=function(){var path=this.get("path"),vertex=this.get("vertex");path&&null!=vertex&&path.removeAt(vertex),this.close()}))}),jQuery(function($){var Parent=map-block.Circle;map-block.OLCircle=function(options,olFeature){this.center={lat:0,lng:0},this.radius=0,Parent.call(this,options,olFeature),this.settings.fillColor||(this.settings.fillColor="#ff0000",this.settings.fillOpacity=.6),this.olStyle=new ol.style.Style(this.getStyleFromSettings());var vectorLayer3857=new ol.layer.Vector({source:new ol.source.Vector,style:this.olStyle});if(olFeature)this.olFeature=olFeature;else{var x,y,wgs84Sphere=new ol.Sphere(6378137),radius=this.radius;x=this.center.lng,y=this.center.lat;var circle3857=ol.geom.Polygon.circular(wgs84Sphere,[x,y],radius,64).clone().transform("EPSG:4326","EPSG:3857");vectorLayer3857.getSource().addFeature(new ol.Feature(circle3857))}this.layer=vectorLayer3857,options.map.olMap.addLayer(vectorLayer3857)},map-block.OLCircle.prototype=Object.create(Parent.prototype),map-block.OLCircle.prototype.constructor=map-block.OLCircle,map-block.OLCircle.prototype.getStyleFromSettings=function(){var params={};return this.settings.strokeOpacity&&(params.stroke=new ol.style.Stroke({color:map-block.hexOpacityToRGBA(this.settings.strokeColor,this.settings.strokeOpacity)})),this.settings.fillOpacity&&(params.fill=new ol.style.Fill({color:map-block.hexOpacityToRGBA(this.settings.fillColor,this.settings.fillOpacity)})),params},map-block.OLCircle.prototype.updateStyleFromSettings=function(){var params=this.getStyleFromSettings();this.olStyle=new ol.style.Style(params),this.layer.setStyle(this.olStyle)}}),jQuery(function($){map-block.OLGeocoder=function(){},map-block.OLGeocoder.prototype=Object.create(map-block.Geocoder.prototype),map-block.OLGeocoder.prototype.constructor=map-block.OLGeocoder,map-block.OLGeocoder.prototype.getResponseFromCache=function(address,callback){$.ajax(map-block.ajaxurl,{data:{action:"map-block_query_nominatim_cache",query:address},success:function(response,xhr,status){response.lng=response.lon,callback(response)}})},map-block.OLGeocoder.prototype.getResponseFromNominatim=function(options,callback){var data={q:options.address,format:"json"};options.country&&(data.countrycodes=options.country),$.ajax("https://nominatim.openstreetmap.org/search/",{data:data,success:function(response,xhr,status){callback(response)},error:function(response,xhr,status){callback(null,map-block.Geocoder.FAIL)}})},map-block.OLGeocoder.prototype.cacheResponse=function(address,response){$.ajax(map-block.ajaxurl,{data:{action:"map-block_store_nominatim_cache",query:address,response:JSON.stringify(response)},method:"POST"})},map-block.OLGeocoder.prototype.getLatLngFromAddress=function(options,callback){return map-block.OLGeocoder.prototype.geocode(options,callback)},map-block.OLGeocoder.prototype.getAddressFromLatLng=function(options,callback){return map-block.OLGeocoder.prototype.geocode(options,callback)},map-block.OLGeocoder.prototype.geocode=function(options,callback){var finish,location,self=this;if(!options)throw new Error("Invalid options");if(options.location&&(options.latLng=new map-block.LatLng(options.location)),options.address)location=options.address,finish=function(response,status){for(var i=0;i<response.length;i++)response[i].geometry={location:new map-block.LatLng({lat:parseFloat(response[i].lat),lng:parseFloat(response[i].lon)})},response[i].latLng={lat:parseFloat(response[i].lat),lng:parseFloat(response[i].lon)},response[i].lng=response[i].lon;callback(response,status)};else{if(!options.latLng)throw new Error("You must supply either a latLng or address");location=options.latLng.toString(),finish=function(response,status){var address=response[0].display_name;callback([address],status)}}this.getResponseFromCache(location,function(response){response.length?finish(response,map-block.Geocoder.SUCCESS):self.getResponseFromNominatim($.extend(options,{address:location}),function(response,status){status!=map-block.Geocoder.FAIL?0!=response.length?(finish(response,map-block.Geocoder.SUCCESS),self.cacheResponse(location,response)):callback([],map-block.Geocoder.ZERO_RESULTS):callback(null,map-block.Geocoder.FAIL)})})}}),jQuery(function($){var Parent;map-block.OLInfoWindow=function(mapObject){var self=this;Parent.call(this,mapObject),this.element=$("<div class='ol-info-window-container ol-info-window-plain'></div>")[0],$(this.element).on("click",".ol-info-window-close",function(event){self.close()})},Parent=map-block.isProVersion()?map-block.ProInfoWindow:map-block.InfoWindow,map-block.OLInfoWindow.prototype=Object.create(Parent.prototype),map-block.OLInfoWindow.prototype.constructor=map-block.OLInfoWindow,map-block.OLInfoWindow.prototype.open=function(map,mapObject){var latLng=mapObject.getPosition();if(!map-block.InfoWindow.prototype.open.call(this,map,mapObject))return!1;this.overlay&&this.mapObject.map.olMap.removeOverlay(this.overlay),this.overlay=new ol.Overlay({element:this.element}),this.overlay.setPosition(ol.proj.fromLonLat([latLng.lng,latLng.lat])),this.mapObject.map.olMap.addOverlay(this.overlay),$(this.element).show(),this.dispatchEvent("infowindowopen")},map-block.OLInfoWindow.prototype.close=function(event){$(this.element).hide(),this.overlay&&(map-block.InfoWindow.prototype.close.call(this),this.mapObject.map.olMap.removeOverlay(this.overlay),this.overlay=null)},map-block.OLInfoWindow.prototype.setContent=function(html){$(this.element).html("<i class='fa fa-times ol-info-window-close' aria-hidden='true'></i>"+html)},map-block.OLInfoWindow.prototype.setOptions=function(options){map-block.settings.developer_mode&&console.log(options),options.maxWidth&&$(this.element).css({"max-width":options.maxWidth+"px"})}}),jQuery(function($){var Parent;map-block.OLMap=function(element,options){var self=this;Parent.call(this,element),this.setOptions(options);var marker,viewOptions=this.settings.toOLViewOptions();$(this.element).html(""),this.olMap=new ol.Map({target:$(element)[0],layers:[this.getTileLayer()],view:new ol.View(viewOptions)}),this.olMap.getInteractions().forEach(function(interaction){interaction instanceof ol.interaction.DragPan?interaction.setActive("yes"!=this.settings.map-block_settings_map_draggable):interaction instanceof ol.interaction.DoubleClickZoom?interaction.setActive(!this.settings.map-block_settings_map_clickzoom):interaction instanceof ol.interaction.MouseWheelZoom&&interaction.setActive("yes"!=this.settings.map-block_settings_map_scroll)},this),this.olMap.getControls().forEach(function(control){control instanceof ol.control.Zoom&&"yes"==map-block.settings.map-block_settings_map_zoom&&this.olMap.removeControl(control)},this),"yes"!=map-block.settings.map-block_settings_map_full_screen_control&&this.olMap.addControl(new ol.control.FullScreen),this.markerLayer=new ol.layer.Vector({source:new ol.source.Vector({features:[]})}),this.olMap.addLayer(this.markerLayer),this.olMap.on("movestart",function(event){self.isBeingDragged=!0}),this.olMap.on("moveend",function(event){self.wrapLongitude(),self.isBeingDragged=!1,self.dispatchEvent("dragend"),self.onIdle()}),this.olMap.getView().on("change:resolution",function(event){self.dispatchEvent("zoom_changed"),self.dispatchEvent("zoomchanged"),self.onIdle()}),this.olMap.getView().on("change",function(){self.onBoundsChanged()}),self.onBoundsChanged(),this.storeLocator&&(marker=this.storeLocator.centerPointMarker)&&(this.olMap.addOverlay(marker.overlay),marker.setVisible(!1)),$(this.element).on("click contextmenu",function(event){var isRight;event=event||window.event;var latLng=self.pixelsToLatLng(event.offsetX,event.offsetY);if("which"in event?isRight=3==event.which:"button"in event&&(isRight=2==event.button),1!=event.which&&1!=event.button){if(isRight)return self.onRightClick(event)}else{if(self.isBeingDragged)return;self.trigger({type:"click",latLng:latLng})}}),map-block.isProVersion()||(this.dispatchEvent("created"),map-block.events.dispatchEvent({type:"mapcreated",map:this}))},Parent=map-block.isProVersion()?map-block.ProMap:map-block.Map,map-block.OLMap.prototype=Object.create(Parent.prototype),map-block.OLMap.prototype.constructor=map-block.OLMap,map-block.OLMap.prototype.getTileLayer=function(){return new ol.layer.Tile({source:new ol.source.OSM})},map-block.OLMap.prototype.wrapLongitude=function(){var center=this.getCenter();-180<=center.lng&&center.lng<=180||(center.lng=center.lng-360*Math.floor(center.lng/360),180<center.lng&&(center.lng-=360),this.setCenter(center))},map-block.OLMap.prototype.getCenter=function(){var lonLat=ol.proj.toLonLat(this.olMap.getView().getCenter());return{lat:lonLat[1],lng:lonLat[0]}},map-block.OLMap.prototype.setCenter=function(latLng){var view=this.olMap.getView();map-block.Map.prototype.setCenter.call(this,latLng),view.setCenter(ol.proj.fromLonLat([latLng.lng,latLng.lat])),this.wrapLongitude(),this.onBoundsChanged()},map-block.OLMap.prototype.getBounds=function(){var bounds=this.olMap.getView().calculateExtent(this.olMap.getSize()),topLeft=ol.proj.toLonLat([bounds[0],bounds[1]]),bottomRight=ol.proj.toLonLat([bounds[2],bounds[3]]);return{topLeft:{lat:topLeft[1],lng:topLeft[0]},bottomRight:{lat:bottomRight[1],lng:bottomRight[0]}}},map-block.OLMap.prototype.fitBounds=function(southWest,northEast){this.olMap.getView().fitExtent([southWest.lng,southWest.lat,northEast.lng,northEast.lat],this.olMap.getSize())},map-block.OLMap.prototype.panTo=function(latLng){this.olMap.getView().animate({center:ol.proj.fromLonLat([parseFloat(latLng.lng),parseFloat(latLng.lat)]),duration:500})},map-block.OLMap.prototype.getZoom=function(){return Math.round(this.olMap.getView().getZoom())+1},map-block.OLMap.prototype.setZoom=function(value){this.olMap.getView().setZoom(value)},map-block.OLMap.prototype.getMinZoom=function(){return this.olMap.getView().getMinZoom()},map-block.OLMap.prototype.setMinZoom=function(value){this.olMap.getView().setMinZoom(value)},map-block.OLMap.prototype.getMaxZoom=function(){return this.olMap.getView().getMaxZoom()},map-block.OLMap.prototype.setMaxZoom=function(value){this.olMap.getView().setMaxZoom(value)},map-block.OLMap.prototype.setOptions=function(options){Parent.prototype.setOptions.call(this,options),this.olMap&&this.olMap.getView().setProperties(this.settings.toOLViewOptions())},map-block.OLMap.prototype.addMarker=function(marker){this.olMap.addOverlay(marker.overlay),Parent.prototype.addMarker.call(this,marker)},map-block.OLMap.prototype.removeMarker=function(marker){this.olMap.removeOverlay(marker.overlay),Parent.prototype.removeMarker.call(this,marker)},map-block.OLMap.prototype.addPolygon=function(polygon){this.olMap.addLayer(polygon.layer),Parent.prototype.addPolygon.call(this,polygon)},map-block.OLMap.prototype.removePolygon=function(polygon){this.olMap.removeLayer(polygon.layer),Parent.prototype.removePolygon.call(this,polygon)},map-block.OLMap.prototype.addPolyline=function(polyline){this.olMap.addLayer(polyline.layer),Parent.prototype.addPolyline.call(this,polyline)},map-block.OLMap.prototype.removePolyline=function(polyline){this.olMap.removeLayer(polyline.layer),Parent.prototype.removePolyline.call(this,polyline)},map-block.OLMap.prototype.addCircle=function(circle){this.olMap.addLayer(circle.layer),Parent.prototype.addCircle.call(this,circle)},map-block.OLMap.prototype.removeCircle=function(circle){this.olMap.removeLayer(circle.layer),Parent.prototype.removeCircle.call(this,circle)},map-block.OLMap.prototype.pixelsToLatLng=function(x,y){null==y&&("x"in x&&"y"in x?(y=x.y,x=x.x):console.warn("Y coordinate undefined in pixelsToLatLng (did you mean to pass 2 arguments?)"));var coord=this.olMap.getCoordinateFromPixel([x,y]);if(!coord)return{x:null,y:null};var lonLat=ol.proj.toLonLat(coord);return{lat:lonLat[1],lng:lonLat[0]}},map-block.OLMap.prototype.latLngToPixels=function(latLng){var coord=ol.proj.fromLonLat([latLng.lng,latLng.lat]),pixel=this.olMap.getPixelFromCoordinate(coord);return pixel?{x:pixel[0],y:pixel[1]}:{x:null,y:null}},map-block.OLMap.prototype.enableBicycleLayer=function(value){if(value)this.bicycleLayer||(this.bicycleLayer=new ol.layer.Tile({source:new ol.source.OSM({url:"http://{a-c}.tile.opencyclemap.org/cycle/{z}/{x}/{y}.png"})})),this.olMap.addLayer(this.bicycleLayer);else{if(!this.bicycleLayer)return;this.olMap.removeLayer(this.bicycleLayer)}},map-block.OLMap.prototype.onElementResized=function(event){this.olMap.updateSize()},map-block.OLMap.prototype.onRightClick=function(event){if($(event.target).closest(".ol-marker, .map-block_modern_infowindow, .map-block-modern-store-locator").length)return!0;var parentOffset=$(this.element).offset(),relX=event.pageX-parentOffset.left,relY=event.pageY-parentOffset.top,latLng=this.pixelsToLatLng(relX,relY);return this.trigger({type:"rightclick",latLng:latLng}),$(this.element).trigger({type:"rightclick",latLng:latLng}),event.preventDefault(),!1}}),jQuery(function($){var Parent;map-block.OLMarker=function(row){var self=this;Parent.call(this,row);var origin=ol.proj.fromLonLat([parseFloat(this.lng),parseFloat(this.lat)]);this.element=$("<div class='ol-marker'><img src='"+map-block.settings.default_marker_icon+"'/></div>")[0],this.element.map-blockMarker=this,$(this.element).on("mouseover",function(event){self.dispatchEvent("mouseover")}),this.overlay=new ol.Overlay({element:this.element}),this.overlay.setPosition(origin),this.animation&&this.setAnimation(this.animation),this.setLabel(this.settings.label),row&&row.draggable&&this.setDraggable(!0),this.rebindClickListener(),this.trigger("init")},Parent=map-block.isProVersion()?map-block.ProMarker:map-block.Marker,map-block.OLMarker.prototype=Object.create(Parent.prototype),map-block.OLMarker.prototype.constructor=map-block.OLMarker,map-block.OLMarker.prototype.addLabel=function(){this.setLabel(this.getLabelText())},map-block.OLMarker.prototype.setLabel=function(label){label?(this.label||(this.label=$("<div class='ol-marker-label'/>"),$(this.element).append(this.label)),this.label.html(label)):this.label&&$(this.element).find(".ol-marker-label").remove()},map-block.OLMarker.prototype.setVisible=function(visible){Parent.prototype.setVisible(visible),this.overlay.getElement().style.display=visible?"block":"none"},map-block.OLMarker.prototype.setPosition=function(latLng){Parent.prototype.setPosition.call(this,latLng);var origin=ol.proj.fromLonLat([parseFloat(this.lng),parseFloat(this.lat)]);this.overlay.setPosition(origin)},map-block.OLMarker.prototype.setOffset=function(x,y){this.element.style.position="relative",this.element.style.left=x+"px",this.element.style.top=y+"px"},map-block.OLMarker.prototype.setAnimation=function(anim){switch(Parent.prototype.setAnimation.call(this,anim),anim){case map-block.Marker.ANIMATION_NONE:$(this.element).removeAttr("data-anim");break;case map-block.Marker.ANIMATION_BOUNCE:$(this.element).attr("data-anim","bounce");break;case map-block.Marker.ANIMATION_DROP:$(this.element).attr("data-anim","drop")}},map-block.OLMarker.prototype.setDraggable=function(draggable){var self=this;if(draggable){var options={disabled:!1};this.jQueryDraggableInitialized||(options.start=function(event){self.onDragStart(event)},options.stop=function(event){self.onDragEnd(event)}),$(this.element).draggable(options),this.jQueryDraggableInitialized=!0,this.rebindClickListener()}else $(this.element).draggable({disabled:!0})},map-block.OLMarker.prototype.onDragStart=function(event){this.isBeingDragged=!0},map-block.OLMarker.prototype.onDragEnd=function(event){var offset_top=parseFloat($(this.element).css("top").match(/-?\d+/)[0]),offset_left=parseFloat($(this.element).css("left").match(/-?\d+/)[0]);$(this.element).css({top:"0px",left:"0px"});var currentLatLng=this.getPosition(),pixelsBeforeDrag=this.map.latLngToPixels(currentLatLng),pixelsAfterDrag={x:pixelsBeforeDrag.x+offset_left,y:pixelsBeforeDrag.y+offset_top},latLngAfterDrag=this.map.pixelsToLatLng(pixelsAfterDrag);this.setPosition(latLngAfterDrag),this.isBeingDragged=!1,this.trigger({type:"dragend",latLng:latLngAfterDrag})},map-block.OLMarker.prototype.onElementClick=function(event){var self=event.currentTarget.map-blockMarker;self.isBeingDragged||(self.dispatchEvent("click"),self.dispatchEvent("select"))},map-block.OLMarker.prototype.rebindClickListener=function(){$(this.element).off("click",this.onElementClick),$(this.element).on("click",this.onElementClick)}}),jQuery(function($){map-block.OLModernStoreLocatorCircle=function(map,settings){map-block.ModernStoreLocatorCircle.call(this,map,settings)},map-block.OLModernStoreLocatorCircle.prototype=Object.create(map-block.ModernStoreLocatorCircle.prototype),map-block.OLModernStoreLocatorCircle.prototype.constructor=map-block.OLModernStoreLocatorCircle,map-block.OLModernStoreLocatorCircle.prototype.initCanvasLayer=function(){var self=this,mapElement=$(this.map.element),olViewportElement=mapElement.children(".ol-viewport");this.canvas=document.createElement("canvas"),this.canvas.className="map-block-ol-canvas-overlay",mapElement.append(this.canvas),this.renderFunction=function(event){self.canvas.width==olViewportElement.width()&&self.canvas.height==olViewportElement.height()||(self.canvas.width=olViewportElement.width(),self.canvas.height=olViewportElement.height(),$(this.canvas).css({width:olViewportElement.width()+"px",height:olViewportElement.height()+"px"})),self.draw()},this.map.olMap.on("postrender",this.renderFunction)},map-block.OLModernStoreLocatorCircle.prototype.getContext=function(type){return this.canvas.getContext(type)},map-block.OLModernStoreLocatorCircle.prototype.getCanvasDimensions=function(){return{width:this.canvas.width,height:this.canvas.height}},map-block.OLModernStoreLocatorCircle.prototype.getCenterPixels=function(){return this.map.latLngToPixels(this.settings.center)},map-block.OLModernStoreLocatorCircle.prototype.getWorldOriginOffset=function(){return{x:0,y:0}},map-block.OLModernStoreLocatorCircle.prototype.getTransformedRadius=function(km){var center=new map-block.LatLng(this.settings.center),outer=new map-block.LatLng(center);outer.moveByDistance(km,90);var centerPixels=this.map.latLngToPixels(center),outerPixels=this.map.latLngToPixels(outer);return Math.abs(outerPixels.x-centerPixels.x)},map-block.OLModernStoreLocatorCircle.prototype.getScale=function(){return 1},map-block.OLModernStoreLocatorCircle.prototype.destroy=function(){$(this.canvas).remove(),this.map.olMap.un("postrender",this.renderFunction),this.map=null,this.canvas=null}}),jQuery(function($){map-block.OLModernStoreLocator=function(map_id){map-block.ModernStoreLocator.call(this,map_id),(map-block.isProVersion()?$(".map-block_map[data-map-id='"+map_id+"']"):$("#map-block_map")).append(this.element)},map-block.OLModernStoreLocator.prototype=Object.create(map-block.ModernStoreLocator),map-block.OLModernStoreLocator.prototype.constructor=map-block.OLModernStoreLocator}),jQuery(function($){var Parent;map-block.OLPolygon=function(row,olFeature){if(Parent.call(this,row,olFeature),this.olStyle=new ol.style.Style,olFeature)this.olFeature=olFeature;else{var coordinates=[[]];if(row&&row.points){for(var paths=this.parseGeometry(row.points),i=0;i<paths.length;i++)coordinates[0].push(ol.proj.fromLonLat([parseFloat(paths[i].lng),parseFloat(paths[i].lat)]));this.olStyle=new ol.style.Style(this.getStyleFromSettings())}this.olFeature=new ol.Feature({geometry:new ol.geom.Polygon(coordinates)})}this.layer=new ol.layer.Vector({source:new ol.source.Vector({features:[this.olFeature]}),style:this.olStyle}),this.layer.getSource().getFeatures()[0].setProperties({map-blockPolygon:this})},Parent=map-block.isProVersion()?map-block.ProPolygon:map-block.Polygon,map-block.OLPolygon.prototype=Object.create(Parent.prototype),map-block.OLPolygon.prototype.constructor=map-block.OLPolygon,map-block.OLPolygon.prototype.getStyleFromSettings=function(){var params={};return this.settings.strokeOpacity&&(params.stroke=new ol.style.Stroke({color:map-block.hexOpacityToRGBA(this.settings.strokeColor,this.settings.strokeOpacity)})),this.settings.fillOpacity&&(params.fill=new ol.style.Fill({color:map-block.hexOpacityToRGBA(this.settings.fillColor,this.settings.fillOpacity)})),params},map-block.OLPolygon.prototype.updateStyleFromSettings=function(){var params=this.getStyleFromSettings();this.olStyle=new ol.style.Style(params),this.layer.setStyle(this.olStyle)},map-block.OLPolygon.prototype.setEditable=function(editable){},map-block.OLPolygon.prototype.toJSON=function(){var result=Parent.prototype.toJSON.call(this),coordinates=this.olFeature.getGeometry().getCoordinates()[0];result.points=[];for(var i=0;i<coordinates.length;i++){var lonLat=ol.proj.toLonLat(coordinates[i]),latLng={lat:lonLat[1],lng:lonLat[0]};result.points.push(latLng)}return result}}),jQuery(function($){var Parent;map-block.OLPolyline=function(row,olFeature){if(map-block.Polyline.call(this,row),this.olStyle=new ol.style.Style,olFeature)this.olFeature=olFeature;else{var coordinates=[];if(row&&row.points)for(var path=this.parseGeometry(row.points),i=0;i<path.length;i++)coordinates.push(ol.proj.fromLonLat([parseFloat(path[i].lng),parseFloat(path[i].lat)]));var params=this.getStyleFromSettings();this.olStyle=new ol.style.Style(params),this.olFeature=new ol.Feature({geometry:new ol.geom.LineString(coordinates)})}this.layer=new ol.layer.Vector({source:new ol.source.Vector({features:[this.olFeature]}),style:this.olStyle}),this.layer.getSource().getFeatures()[0].setProperties({map-blockPolyling:this})},Parent=map-block.Polyline,map-block.OLPolyline.prototype=Object.create(Parent.prototype),map-block.OLPolyline.prototype.constructor=map-block.OLPolyline,map-block.OLPolyline.prototype.getStyleFromSettings=function(){var params={};return this.settings.strokeOpacity&&(params.stroke=new ol.style.Stroke({color:map-block.hexOpacityToRGBA(this.settings.strokeColor,this.settings.strokeOpacity),width:parseInt(this.settings.strokeWeight)})),params},map-block.OLPolyline.prototype.updateStyleFromSettings=function(){var params=this.getStyleFromSettings();this.olStyle=new ol.style.Style(params),this.layer.setStyle(this.olStyle)},map-block.OLPolyline.prototype.setEditable=function(editable){},map-block.OLPolyline.prototype.setPoints=function(points){this.olFeature&&this.layer.getSource().removeFeature(this.olFeature);for(var coordinates=[],i=0;i<points.length;i++)coordinates.push(ol.proj.fromLonLat([parseFloat(points[i].lng),parseFloat(points[i].lat)]));this.olFeature=new ol.Feature({geometry:new ol.geom.LineString(coordinates)}),this.layer.getSource().addFeature(this.olFeature)},map-block.OLPolyline.prototype.toJSON=function(){var result=Parent.prototype.toJSON.call(this),coordinates=this.olFeature.getGeometry().getCoordinates();result.points=[];for(var i=0;i<coordinates.length;i++){var lonLat=ol.proj.toLonLat(coordinates[i]),latLng={lat:lonLat[1],lng:lonLat[0]};result.points.push(latLng)}return result}});